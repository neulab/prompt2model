{"pretrained_model_name": "facebook/xglm-4.5B", "description": "---\nlanguage:\n- multilingual\n- en\n- ru\n- zh\n- de\n- es\n- fr\n- ja\n- it\n- pt\n- el\n- ko\n- fi\n- id\n- tr\n- ar\n- vi\n- th\n- bg\n- ca\n- hi\n- et\n- bn\n- ta\n- ur\n- sw\n- te\n- eu\n- my\n- ht\n- qu\nlicense: mit\nthumbnail: https://huggingface.co/front/thumbnails/facebook.png\ninference: false\n---\n\n# XGLM-4.5B\n\nXGLM-4.5B is a multilingual autoregressive language model (with 4.5 billion parameters) trained on a balanced corpus of a diverse set of 134 languages. It was introduced in the paper [Few-shot Learning with Multilingual Language Models](https://arxiv.org/abs/2112.10668) by Xi Victoria Lin\\*, Todor Mihaylov, Mikel Artetxe, Tianlu Wang, Shuohui Chen, Daniel Simig, Myle Ott, Naman Goyal, Shruti Bhosale, Jingfei Du, Ramakanth Pasunuru, Sam Shleifer, Punit Singh Koura, Vishrav Chaudhary, Brian O'Horo, Jeff Wang, Luke Zettlemoyer, Zornitsa Kozareva, Mona Diab, Veselin Stoyanov, Xian Li\\* (\\*Equal Contribution). The original implementation was released in [this repository](https://github.com/pytorch/fairseq/tree/main/examples/xglm).\n\n## Model card\n\nFor intended usage of the model, please refer to the [model card](https://github.com/pytorch/fairseq/blob/main/examples/xglm/model_card.md) released by the XGLM-4.5B development team. \n\n## Example (COPA)\nThe following snippet shows how to evaluate our models (GPT-3 style, zero-shot) on the Choice of Plausible Alternatives (COPA) task, using examples in English, Chinese and Hindi.\n\n```python\nimport torch\nimport torch.nn.functional as F\n\nfrom transformers import XGLMTokenizer, XGLMForCausalLM\n\ntokenizer = XGLMTokenizer.from_pretrained(\"facebook/xglm-4.5B\")\nmodel = XGLMForCausalLM.from_pretrained(\"facebook/xglm-4.5B\")\n\ndata_samples = {\n    'en': [\n        {\n            \"premise\": \"I wanted to conserve energy.\",\n            \"choice1\": \"I swept the floor in the unoccupied room.\",\n            \"choice2\": \"I shut off the light in the unoccupied room.\",\n            \"question\": \"effect\",\n            \"label\": \"1\"\n        },\n        {\n            \"premise\": \"The flame on the candle went out.\",\n            \"choice1\": \"I blew on the wick.\",\n            \"choice2\": \"I put a match to the wick.\",\n            \"question\": \"cause\",\n            \"label\": \"0\"\n        }\n    ],\n    'zh': [\n        {\n            \"premise\": \"\u6211\u60f3\u8282\u7ea6\u80fd\u6e90\u3002\",\n            \"choice1\": \"\u6211\u5728\u7a7a\u7740\u7684\u623f\u95f4\u91cc\u626b\u4e86\u5730\u677f\u3002\",\n            \"choice2\": \"\u6211\u628a\u7a7a\u623f\u95f4\u91cc\u7684\u706f\u5173\u4e86\u3002\",\n            \"question\": \"effect\",\n            \"label\": \"1\"\n        },\n        {\n            \"premise\": \"\u8721\u70db\u4e0a\u7684\u706b\u7130\u7184\u706d\u4e86\u3002\",\n            \"choice1\": \"\u6211\u5439\u706d\u4e86\u706f\u82af\u3002\",\n            \"choice2\": \"\u6211\u628a\u4e00\u6839\u706b\u67f4\u653e\u5728\u706f\u82af\u4e0a\u3002\",\n            \"question\": \"cause\",\n            \"label\": \"0\"\n        }\n    ],\n    'hi': [\n        {\n            \"premise\": \"M te vle kons\u00e8ve en\u00e8ji.\",\n            \"choice1\": \"Mwen te fin baleye chanm lib la.\",\n            \"choice2\": \"Mwen te femen limy\u00e8 nan chanm lib la.\",\n            \"question\": \"effect\",\n            \"label\": \"1\"\n        },\n        {\n            \"premise\": \"Flam bouji a te etenn.\",\n            \"choice1\": \"Mwen te soufle bouji a.\",\n            \"choice2\": \"Mwen te limen m\u00e8ch bouji a.\",\n            \"question\": \"cause\",\n            \"label\": \"0\"\n        }\n    ]\n}\n\ndef get_logprobs(prompt):\n    inputs = tokenizer(prompt, return_tensors=\"pt\")\n    input_ids, output_ids = inputs[\"input_ids\"], inputs[\"input_ids\"][:, 1:]\n    outputs = model(**inputs, labels=input_ids)\n    logits = outputs.logits\n    logprobs = torch.gather(F.log_softmax(logits, dim=2), 2, output_ids.unsqueeze(2))\n    return logprobs\n\n# Zero-shot evaluation for the Choice of Plausible Alternatives (COPA) task.\n# A return value of 0 indicates that the first alternative is more plausible,\n# while 1 indicates that the second alternative is more plausible.\ndef COPA_eval(prompt, alternative1, alternative2):\n    lprob1 = get_logprobs(prompt + \"\\n\" + alternative1).sum()\n    lprob2 = get_logprobs(prompt + \"\\n\" + alternative2).sum()\n    return 0 if lprob1 > lprob2 else 1\n\nfor lang in data_samples_long:\n    for idx, example in enumerate(data_samples_long[lang]):\n        predict = COPA_eval(example[\"premise\"], example[\"choice1\"], example[\"choice2\"])\n        print(f'{lang}-{idx}', predict, example['label'])\n        \n# en-0 1 1\n# en-1 0 0\n# zh-0 1 1\n# zh-1 0 0\n# hi-0 1 1\n# hi-1 0 0\n```", "size_bytes": "10153902621", "downloads": 708}