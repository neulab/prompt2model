{"pretrained_model_name": "Finnish-NLP/gpt2-large-finnish", "description": "---\nlanguage:\n- fi\nlicense: apache-2.0\ntags:\n- finnish\n- gpt2\ndatasets:\n- Finnish-NLP/mc4_fi_cleaned\n- wikipedia\nwidget:\n- text: \"Teksti\u00e4 tuottava teko\u00e4ly on\"\n\n---\n\n# GPT-2 large for Finnish\n\nPretrained GPT-2 large model on Finnish language using a causal language modeling (CLM) objective. GPT-2 was introduced in\n[this paper](https://d4mucfpksywv.cloudfront.net/better-language-models/language_models_are_unsupervised_multitask_learners.pdf)\nand first released at [this page](https://openai.com/blog/better-language-models/).\n\n**Note**: this model is 774M parameter variant as in Huggingface's [GPT-2-large config](https://huggingface.co/gpt2-large), so not the famous big 1.5B parameter variant by OpenAI.\n\n## Model description\n\nFinnish GPT-2 is a transformers model pretrained on a very large corpus of Finnish data in a self-supervised fashion. This\nmeans it was pretrained on the raw texts only, with no humans labelling them in any way (which is why it can use lots\nof publicly available data) with an automatic process to generate inputs and labels from those texts. More precisely,\nit was trained to guess the next word in sentences.\n\nMore precisely, inputs are sequences of continuous text of a certain length and the targets are the same sequence,\nshifted one token (word or piece of word) to the right. The model uses internally a mask-mechanism to make sure the\npredictions for the token `i` only uses the inputs from `1` to `i` but not the future tokens.\n\nThis way, the model learns an inner representation of the Finnish language that can then be used to extract features\nuseful for downstream tasks. The model is best at what it was pretrained for however, which is generating texts from a\nprompt.\n\n## Intended uses & limitations\n\nYou can use the raw model for text generation or fine-tune it to a downstream task. See the\n[model hub](https://huggingface.co/models?filter=gpt2) to look for fine-tuned versions on a task that interests you.\n\n### How to use\n\nYou can use this model directly with a pipeline for text generation:\n\n```python\n>>> from transformers import pipeline\n>>> generator = pipeline('text-generation', model='Finnish-NLP/gpt2-large-finnish')\n>>> generator(\"Teksti\u00e4 tuottava teko\u00e4ly on\", max_length=30, num_return_sequences=5)\n\n[{'generated_text': 'Teksti\u00e4 tuottava teko\u00e4ly on valmis yhteisty\u00f6h\u00f6n ihmisen kanssa: Teko\u00e4ly hoitaa ihmisen puolesta tekstin tuottamisen. Se my\u00f6s ymm\u00e4rt\u00e4\u00e4, miss\u00e4 vaiheessa teksti\u00e4 voidaan alkaa kirjoittamaan'},\n {'generated_text': 'Teksti\u00e4 tuottava teko\u00e4ly on \u00e4lyk\u00e4s, mutta se ei ole vain \u00e4lykk\u00e4isiin koneisiin kuuluva \u00e4lyk\u00e4s olento, vaan se on my\u00f6s kone. Se ei'},\n {'generated_text': 'Teksti\u00e4 tuottava teko\u00e4ly on ehk\u00e4 jo pian todellisuutta - se voisi tehd\u00e4 my\u00f6s vanhustenhoidosta nykyist\u00e4 \u00e4 tuottava teko\u00e4ly on ehk\u00e4 jo pian todellisuutta - se voisi tehd\u00e4'},\n {'generated_text': 'Teksti\u00e4 tuottava teko\u00e4ly on kehitetty ihmisen ja ihmisen aivoihin yhteisty\u00f6ss\u00e4 neurotieteiden ja k\u00e4ytt\u00e4ytymistieteen tutkijatiimin kanssa. Uusi teknologia avaa aivan uudenlaisia tutkimusi'},\n {'generated_text': 'Teksti\u00e4 tuottava teko\u00e4ly on kuin tietokone, jonka kanssa voi el\u00e4\u00e4. Teko\u00e4lyn avulla voi kirjoittaa mit\u00e4 tahansa, mist\u00e4 tahansa ja miten paljon. T\u00e4ss\u00e4'}]\n```\n\nHere is how to use this model to get the features of a given text in PyTorch:\n\n```python\nfrom transformers import GPT2Tokenizer, GPT2Model\ntokenizer = GPT2Tokenizer.from_pretrained('Finnish-NLP/gpt2-large-finnish')\nmodel = GPT2Model.from_pretrained('Finnish-NLP/gpt2-large-finnish')\ntext = \"Replace me by any text you'd like.\"\nencoded_input = tokenizer(text, return_tensors='pt')\noutput = model(**encoded_input)\n```\n\nand in TensorFlow:\n\n```python\nfrom transformers import GPT2Tokenizer, TFGPT2Model\ntokenizer = GPT2Tokenizer.from_pretrained('Finnish-NLP/gpt2-large-finnish')\nmodel = TFGPT2Model.from_pretrained('Finnish-NLP/gpt2-large-finnish', from_pt=True)\ntext = \"Replace me by any text you'd like.\"\nencoded_input = tokenizer(text, return_tensors='tf')\noutput = model(encoded_input)\n```\n\n### Limitations and bias\n\nThe training data used for this model contains a lot of unfiltered content from the internet, which is far from neutral. Therefore, the model can have biased predictions. This bias will also affect all fine-tuned versions of this model.\n\nAs with all language models, it is hard to predict in advance how the Finnish GPT-2 will respond to particular prompts and offensive content may occur without warning. We recommend having a human curate or filter the outputs before releasing them, both to censor undesirable content and to improve the quality of the results.\n\n## Training data\n\nThis Finnish GPT-2 model was pretrained on the combination of six datasets:\n- [mc4_fi_cleaned](https://huggingface.co/datasets/Finnish-NLP/mc4_fi_cleaned), the dataset mC4 is a multilingual colossal, cleaned version of Common Crawl's web crawl corpus. We used the Finnish subset of the mC4 dataset and further cleaned it with our own text data cleaning codes (check the dataset repo).\n- [wikipedia](https://huggingface.co/datasets/wikipedia) We used the Finnish subset of the wikipedia (August 2021) dataset\n- [Yle Finnish News Archive 2011-2018](http://urn.fi/urn:nbn:fi:lb-2017070501)\n- [Yle Finnish News Archive 2019-2020](http://urn.fi/urn:nbn:fi:lb-2021050401)\n- [Finnish News Agency Archive (STT)](http://urn.fi/urn:nbn:fi:lb-2018121001)\n- [The Suomi24 Sentences Corpus](http://urn.fi/urn:nbn:fi:lb-2020021803)\n\nRaw datasets were cleaned to filter out bad quality and non-Finnish examples. Together these cleaned datasets were around 84GB of text.\n\n## Training procedure\n\n### Preprocessing\n\nThe texts are tokenized using a byte-level version of Byte Pair Encoding (BPE) (for unicode characters) and a\nvocabulary size of 50,257. The inputs are sequences of 512 consecutive tokens.\n\n### Pretraining\n\nThe model was trained on TPUv3-8 VM, sponsored by the [Google TPU Research Cloud](https://sites.research.google/trc/about/), for 640k steps (a bit over 1 epoch, 64 batch size). The optimizer used was a AdamW with learning rate 4e-5, learning rate warmup for 4000 steps and cosine decay of the learning rate after.\n\n\n## Evaluation results\n\nEvaluation was done using the *validation* split of the [mc4_fi_cleaned](https://huggingface.co/datasets/Finnish-NLP/mc4_fi_cleaned) dataset with [Perplexity](https://huggingface.co/course/chapter7/3#perplexity-for-language-models) (smaller score the better) as the evaluation metric. As seen from the table below, this model (the first row of the table) performs better than our smaller model variants.\n\n|                                          | Perplexity |\n|------------------------------------------|------------|\n|Finnish-NLP/gpt2-large-finnish            |**30.74**   |\n|Finnish-NLP/gpt2-medium-finnish           |34.08       |\n|Finnish-NLP/gpt2-finnish                  |44.19       |\n\n## Acknowledgements\n\nThis project would not have been possible without compute generously provided by Google through the\n[TPU Research Cloud](https://sites.research.google/trc/).\n\n## Team Members\n\n- Aapo Tanskanen, [Hugging Face profile](https://huggingface.co/aapot), [LinkedIn profile](https://www.linkedin.com/in/aapotanskanen/)\n- Rasmus Toivanen, [Hugging Face profile](https://huggingface.co/RASMUS), [LinkedIn profile](https://www.linkedin.com/in/rasmustoivanen/)\n\nFeel free to contact us for more details \ud83e\udd17", "size_bytes": "3134045897", "downloads": 78}