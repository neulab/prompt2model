{"pretrained_model_name": "crumb/bloom-560m-RLHF-SD2-prompter-aesthetic", "description": "---\nlicense: bigscience-bloom-rail-1.0\ntags:\n- stable-diffusion\n- diffusion\nmodel-index:\n- name: bloom-560m-RLHF-SD2-prompter\n  results: []\n  \ndatasets:\n - Gustavosta/Stable-Diffusion-Prompts\n\nwidget:\n- text: \"<s>Prompt: \"\n\ninference:\n  parameters:\n    eos_token_id: 2\n    max_length: 128\n    do_sample: true\n---\n\n# The RAT (RLHF-Aesthetic Tuned model for prompt synthesis)\n\n**COLAB DEMO INCLUDING STABLE DIFFUSION: https://colab.research.google.com/github/aicrumb/doohickey/blob/main/rlhf_prompt_tuner.ipynb**\n\nThis is a further finetuned version of [crumb/bloom-560m-RLHF-SD2-prompter](https://hf.co/crumb/bloom-560m-RLHF-SD2-prompter) to optimize for aesthetic score with models from https://github.com/crowsonkb/simulacra-aesthetic-models instead of me hand scoring each image\n\ndonate so i can do this on real hardware : https://github.com/aicrumb/aicrumb/blob/main/README.md\n\ntrained at bs=32, lr=0.0001, only tuning biases and layernorm weights\n\n## Example usage\n\n```python\n# Install libraries needed to run the models\n!pip install transformers diffusers accelerate -qq\n\n# Import the libraries\nfrom diffusers import StableDiffusionPipeline, EulerDiscreteScheduler\nfrom transformers import pipeline\nimport torch\n\n# This is the model that the transformer was finetuned to generate prompts for\nmodel_id = \"stabilityai/stable-diffusion-2-base\"\n\n# Use the Euler scheduler here\nscheduler = EulerDiscreteScheduler.from_pretrained(model_id, subfolder=\"scheduler\")\npipe = StableDiffusionPipeline.from_pretrained(model_id, scheduler=scheduler, revision=\"fp16\", torch_dtype=torch.float16)\npipe = pipe.to(\"cuda\")\n\n# Load the transformer model\nprompt_pipe = pipeline(\"text-generation\", model=\"crumb/bloom-560m-RLHF-SD2-prompter-aesthetic\")\nprompt = \"cool landscape\"\n\n# Auto-complete prompt\nprompt = \"<s>Prompt: \" + prompt + \",\"\nextended_prompt = prompt_pipe(prompt, do_sample=True, max_length=42)[0]['generated_text']\nextended_prompt = extended_prompt[10:]\nprint(\"Prompt is now: \", extended_prompt)\n\n# Generate image\nimage = pipe(extended_prompt).images[0]  \n\nimage.save(\"output.png\")\nimage\n```\n\n## Limitations\nAesthetic scoring models have been shown to have very large biases, and one I noticed is it really likes images of women no matter the actual quality, so those were optimized for more than other things.\n\nAlso it fell into the trap of rlhf models, it gets kinda same-ey, so if you don't like the general \"stable diffusion, trending on artstation\" look this might not be for you.", "size_bytes": "1118526007", "downloads": 1822}