{"pretrained_model_name": "Den4ikAI/FRED-T5-XL-chitchat", "description": "---\nlicense: mit\nlanguage:\n- ru\npipeline_tag: text2text-generation\nwidget:\n- text: '<SC1>- \u041a\u0430\u043a \u0442\u0435\u0431\u044f \u0437\u043e\u0432\u0443\u0442?\\n- \u0414\u0430\u0448\u0430\\n- \u0410 \u043c\u0435\u043d\u044f \u0414\u0435\u043d\u0438\u0441\\n- <extra_id_0>'\n---\n# Den4ikAI/FRED-T5-XL-chitchat\n\u0411\u043e\u043b\u0442\u0430\u043b\u043a\u0430 \u043d\u0430 \u043e\u0441\u043d\u043e\u0432\u0435 FRED-T5-XL. \u0414\u043b\u0438\u043d\u0430 \u043a\u043e\u043d\u0442\u0435\u043a\u0441\u0442\u0430 \u043c\u043e\u0434\u0435\u043b\u0438 6-8 \u0440\u0435\u043f\u043b\u0438\u043a.\n\n# \u041f\u0440\u0438\u043c\u0435\u0440 \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f\n```python\nimport torch\nimport transformers\n\nuse_cuda = torch.cuda.is_available()\ndevice = torch.device(\"cuda\" if use_cuda else \"cpu\")\n\n\nt5_tokenizer = transformers.GPT2Tokenizer.from_pretrained(\"Den4ikAI/FRED-T5-XL-chitchat\")\nt5_model = transformers.T5ForConditionalGeneration.from_pretrained(\"Den4ikAI/FRED-T5-XL-chitchat\")\n\nwhile True:\n    print('-'*80)\n    dialog = []\n    while True:\n        msg = input('H:> ').strip()\n        if len(msg) == 0:\n            break\n\n        dialog.append('- ' + msg)\n        dialog.append('- <extra_id_0>')\n        input_ids = t5_tokenizer('<SC1>'+'\\n'.join(dialog), return_tensors='pt').input_ids\n        out_ids = t5_model.generate(input_ids=input_ids,\n                                    max_length=200,\n                                    eos_token_id=t5_tokenizer.eos_token_id,\n                                    early_stopping=True,\n                                    do_sample=True,\n                                    temperature=1.0,\n                                    top_k=0,\n                                    top_p=0.85)\n        dialog.pop(-1)\n        t5_output = t5_tokenizer.decode(out_ids[0][1:]).replace('<extra_id_0>','')\n        if '</s>' in t5_output:\n            t5_output = t5_output[:t5_output.find('</s>')].strip()\n\n        print('B:> {}'.format(t5_output))\n        dialog.append('- '+t5_output)\n```\n# Citation\n```\n@MISC{Den4ikAI/FRED-T5-XL-chitchat,\n    author  = {Denis Petrov},\n    title   = {Russian chitchat model},\n    url     = {https://huggingface.co/Den4ikAI/FRED-T5-XL-chitchat},\n    year    = 2023\n}\n```\n", "size_bytes": "3480901445", "downloads": 22}