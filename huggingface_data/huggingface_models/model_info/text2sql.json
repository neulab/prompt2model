{"pretrained_model_name": "dsivakumar/text2sql", "description": "---\nlanguage: \n- en\ndatasets:\n- wikisql\nwidget: \n- text: \"English to SQL: Show me the average age of of wines in Italy by provinces\"\n- text: \"English to SQL: What is the current series where the new series began in June 2011?\"\n---\n#import transformers \n```\nfrom transformers import (\n    T5ForConditionalGeneration,\n    T5Tokenizer,\n)\n\n#load model\n\nmodel = T5ForConditionalGeneration.from_pretrained('dsivakumar/text2sql')\ntokenizer = T5Tokenizer.from_pretrained('dsivakumar/text2sql')\n\n#predict function\n\ndef get_sql(query,tokenizer,model):\n    source_text= \"English to SQL: \"+query\n    source_text = ' '.join(source_text.split())\n    source = tokenizer.batch_encode_plus([source_text],max_length= 128, pad_to_max_length=True, truncation=True, padding=\"max_length\", return_tensors='pt')\n    source_ids = source['input_ids'] #.squeeze()\n    source_mask = source['attention_mask']#.squeeze()\n    generated_ids = model.generate(\n      input_ids = source_ids.to(dtype=torch.long),\n      attention_mask = source_mask.to(dtype=torch.long), \n      max_length=150, \n      num_beams=2,\n      repetition_penalty=2.5, \n      length_penalty=1.0, \n      early_stopping=True\n      )\n    preds = [tokenizer.decode(g, skip_special_tokens=True, clean_up_tokenization_spaces=True) for g in generated_ids]\n    return preds\n \n#test\n\nquery=\"Show me the average age of of wines in Italy by provinces\"\nsql = get_sql(query,tokenizer,model)\nprint(sql)\n\n#https://huggingface.co/mrm8488/t5-small-finetuned-wikiSQL\ndef get_sql(query):\n  input_text = \"translate English to SQL: %s </s>\" % query\n  features = tokenizer([input_text], return_tensors='pt')\n\n  output = model.generate(input_ids=features['input_ids'], \n               attention_mask=features['attention_mask'])\n  \n  return tokenizer.decode(output[0])\n\nquery = \"How many models were finetuned using BERT as base model?\"\n\nget_sql(query)\n```\n", "size_bytes": "242068411", "downloads": 193}