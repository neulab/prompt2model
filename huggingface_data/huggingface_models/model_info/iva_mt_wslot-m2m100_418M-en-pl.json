{"pretrained_model_name": "cartesinus/iva_mt_wslot-m2m100_418M-en-pl", "description": "---\nlicense: mit\ntags:\n- machine translation\n- iva\n- virtual assistants\n- natural-language-understanding\n- nlu\nmetrics:\n- bleu\nmodel-index:\n- name: iva_mt_wslot-m2m100_418M-0.1.0\n  results: []\ndatasets:\n- cartesinus/iva_mt_wslot\nlanguage:\n- pl\n- en\nco2_eq_emissions:\n  emissions: 0.68\n---\n\n<!-- This model card has been generated automatically according to the information the Trainer had access to. You\nshould probably proofread and complete it, then remove this comment. -->\n\n# iva_mt_wslot-m2m100_418M-0.1.0 en-pl\n\nThis model is a fine-tuned version of [facebook/m2m100_418M](https://huggingface.co/facebook/m2m100_418M) on the\n[iva_mt_wslot](https://huggingface.co/datasets/cartesinus/iva_mt_wslot) dataset. It achieves the following results:\n\n1) On the test set (iva_mt):\n- BLEU (plain text): 39.1560\n- BLEU (with slots): 63.8767\n- F1 score: (in preparation)\n\nFor reference BLEU for baseline m2m100-418M (plain text) was 21.9468. Second result (63.8767) is when tags are treated as \"normal\" words in sentence. Therefore that result \nmight be a bit misleading. Please refer to plain text results if you are not sure how to interpret them.\n\n2) WMT20 (en2pl):\n- BLEU (lowercased, tags removed): 15.0863\n- BLEU for baseline m2m100-418M (plain text): 20.2750\n\nFor reference WMT20 submission systems in en-pl direction had between 25 and 30 BLEU\n   \n3) BLEU on the evaluation set (same as in below table 'Training results'): 61.6249\n\n4) On the training set (to see how it adjusted to train):\n- BLEU (plain text): 70.5597\n- BLEU (with slots): 93.8200\n\nBLEU was measured with [sacreBLEU](https://github.com/mjpost/sacrebleu) library.\n\n## Model description, intended uses & limitations\n\nModel is biased towards virtual assistant (IVA) sentences in prediction/translation. These sentences are short, imperatives with a lot of name entities (slots) and \nparticular vocabulary (for example settings name). It can be observed in above results where WMT results are very low while in-domain test is very high.\n\nThis model will most probably force IVA translations on your text. As long as sentences that you are translating are more or less similar to massive and leyzer domains it\nwill be ok. If you will translate out-of-domain sentenences (such as for example News, Medical) that are not very similar then results will drop significantly up to the\npoint where baseline m2m100-418M will be better than this model.\n\nThis model will generate tags in output even if there is not tag in input sentence. Frequency of this depends on input text origin. When testing IVA utterances this occurs \nbetween 3 and 5%. When WMT20 was translated it happened in 40% cases (input text was from News domain).\nThis is not very severe problem and it can be fixed easily in post-processing (simple `sed 's/<[a-z]>//g'` should be enough in most cases).\n\nTranslations with slot annotation very often differ from same sentences when slots are removed. This is quite frequent and it happens between 30 and 50% of translated\nutterances. For example there will be a difference between \"is it raining in barcelona\" and \"is it raining in \\<a\\>barcelona\\<a\\>\". In second case model will more likely\nlocalize name of city to some Polish name (here Lublin, because such city was given in Massive train set). This might be useful if you want to generate more variants.\n\nOne last thing that needs to be mentioned is that BLEU is not particulary good metric to evaluate IVA sentences due to their length and it should be evalued with other\nmetrices (e.g. [GLEU](https://aclanthology.org/P15-2097.pdf)).\n\n## How to use\n\nFirst please make sure to install `pip install transformers`. First download model: \n\n```python\nfrom transformers import M2M100ForConditionalGeneration, M2M100Tokenizer\nimport torch\n\ndef translate(input_text, lang):\n    input_ids = tokenizer(input_text, return_tensors=\"pt\")\n    generated_tokens = model.generate(**input_ids, forced_bos_token_id=tokenizer.get_lang_id(lang))\n    return tokenizer.batch_decode(generated_tokens, skip_special_tokens=True)\n\nmodel_name = \"cartesinus/iva_mt_wslot-m2m100_418M-0.1.0\"\ntokenizer = M2M100Tokenizer.from_pretrained(model_name, src_lang=\"en\", tgt_lang=\"pl\")\nmodel = M2M100ForConditionalGeneration.from_pretrained(model_name)\n```\n\nThen you can translate either plan text like this:\n```python\nprint(translate(\"set the temperature on my thermostat\", \"pl\"))\n```\nor you can translate with slot annotations that will be restored in tgt language:\n```python\nprint(translate(\"wake me up at <a>nine am<a> on <b>friday<b>\", \"pl\")) #translation: obud\u017a mnie o <a>pi\u0105tej rano<a> <b>w tym tygodniu<b>\n```\nLimitations of translation with slot transfer:\n1) Annotated words must be placed between semi-xml tags like this \"this is \\<a\\>example\\<a\\>\"\n2) There is no closing tag for example \"\\<\\a\\>\" in above example - this is done on purpose to ommit problems with backslash escape\n3) If sentence consists of more than one slot then simply use next alphabet letter. For example \"this is \\<a\\>example\\<a\\> with more than \\<b\\>one\\<b\\> slot\"\n4) Please do not add space before first or last annotated word because this particular model was trained this way and it most probably will lower it's results \n\n\n## Training and evaluation data\n\n## Dataset Composition (en-pl)\n| Corpus                                                               | Train  | Dev   | Test  |\n|----------------------------------------------------------------------|--------|-------|-------|\n| [Massive 1.1](https://huggingface.co/datasets/AmazonScience/massive) | 11514  | 2033  | 2974  |\n| [Leyzer 0.2.0](https://github.com/cartesinus/leyzer/tree/0.2.0)      | 3974   | 701   | 1380  |\n| [OpenSubtitles from OPUS](https://opus.nlpl.eu/OpenSubtitles-v1.php) | 2329   | 411   | 500   |\n| [KDE from OPUS](https://opus.nlpl.eu/KDE4.php)                       | 1154   | 241   | 241   |\n| [CCMatrix from Opus](https://opus.nlpl.eu/CCMatrix.php)              | 1096   | 232   | 237   |\n| [Ubuntu from OPUS](https://opus.nlpl.eu/Ubuntu.php)                  | 281    | 60    | 59    |\n| [Gnome from OPUS](https://opus.nlpl.eu/GNOME.php)                    | 14     | 3     | 3     |\n| *total*                                                              | 20362  | 3681  | 5394  |\n\n## Training procedure\n\n### Training hyperparameters\n\nThe following hyperparameters were used during training:\n- learning_rate: 2e-05\n- train_batch_size: 4\n- eval_batch_size: 4\n- seed: 42\n- optimizer: Adam with betas=(0.9,0.999) and epsilon=1e-08\n- lr_scheduler_type: linear\n- num_epochs: 10\n- mixed_precision_training: Native AMP\n\n### Training results\n\n| Training Loss | Epoch | Step  | Validation Loss | BLEU    | Gen Len |\n|:-------------:|:-----:|:-----:|:---------------:|:-------:|:-------:|\n| 0.0178        | 1.0   | 5091  | 0.0171          | 57.4439 | 21.1396 |\n| 0.013         | 2.0   | 10182 | 0.0159          | 58.886  | 21.2285 |\n| 0.0091        | 3.0   | 15273 | 0.0157          | 60.159  | 21.1222 |\n| 0.0073        | 4.0   | 20364 | 0.0159          | 60.5893 | 21.1212 |\n| 0.0054        | 5.0   | 25455 | 0.0161          | 60.6484 | 21.0679 |\n| 0.004         | 6.0   | 30546 | 0.0166          | 61.5283 | 21.0875 |\n| 0.0031        | 7.0   | 35637 | 0.0169          | 61.0439 | 21.1562 |\n| 0.0024        | 8.0   | 40728 | 0.0172          | 61.9427 | 21.2203 |\n| 0.0018        | 9.0   | 45819 | 0.0175          | 61.7325 | 21.1478 |\n| 0.0014        | 10.0  | 50910 | 0.0176          | 61.6249 | 21.157  |\n\n\n### Framework versions\n\n- Transformers 4.26.1\n- Pytorch 1.13.1+cu116\n- Datasets 2.10.1\n- Tokenizers 0.13.2\n\n## Citation\n\nIf you use this model, please cite the following:\n```\n@article{Sowanski2023SlotLI,\n  title={Slot Lost in Translation? Not Anymore: A Machine Translation Model for Virtual Assistants with Type-Independent Slot Transfer},\n  author={Marcin Sowanski and Artur Janicki},\n  journal={2023 30th International Conference on Systems, Signals and Image Processing (IWSSIP)},\n  year={2023},\n  pages={1-5}\n}\n```", "size_bytes": "1944201353", "downloads": 48}