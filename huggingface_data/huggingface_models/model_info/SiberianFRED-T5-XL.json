{"pretrained_model_name": "SiberiaSoft/SiberianFRED-T5-XL", "description": "---\nlicense: mit\ndatasets:\n- SiberiaSoft/SiberianDataset\nlanguage:\n- ru\n- en\npipeline_tag: text2text-generation\nwidget:\n- text: '<SC6>\u0427\u0435\u043b\u043e\u0432\u0435\u043a: \u041f\u043e\u0447\u0435\u043c\u0443 \u0442\u0440\u0430\u0432\u0430 \u0437\u0435\u043b\u0435\u043d\u0430\u044f?\\n\u041e\u0442\u0432\u0435\u0442: <extra_id_0>'\n- text: '<SC1>\u0422\u044b \u0444\u0438\u043b\u043e\u0441\u043e\u0444, \u043b\u044e\u0431\u044f\u0449\u0438\u0439 \u0440\u0430\u0441\u0441\u0443\u0436\u0434\u0430\u0442\u044c. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438 \u0434\u0438\u0430\u043b\u043e\u0433:\\n\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a: \u041f\u0440\u0438\u0432\u0435\u0442\\n\u0422\u044b: <extra_id_0>'\n- text: '<SC1>\u0422\u044b \u0444\u0438\u043b\u043e\u0441\u043e\u0444, \u043b\u044e\u0431\u044f\u0449\u0438\u0439 \u0440\u0430\u0441\u0441\u0443\u0436\u0434\u0430\u0442\u044c. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438 \u0434\u0438\u0430\u043b\u043e\u0433:\\n\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a: \u0412 \u0447\u0435\u043c \u0441\u043c\u044b\u0441\u043b \u0436\u0438\u0437\u043d\u0438?\\n\u0422\u044b: <extra_id_0>'\n- text: '<SC6>\u0427\u0435\u043b\u043e\u0432\u0435\u043a: \u041d\u0430\u043f\u0438\u0448\u0438 10 \u0440\u0430\u0441\u043f\u0440\u043e\u0441\u0442\u0440\u0430\u043d\u0435\u043d\u043d\u044b\u0445 \u0440\u0443\u0433\u0430\u0442\u0435\u043b\u044c\u0441\u0442\u0432.\\n\u041e\u0442\u0432\u0435\u0442: <extra_id_0>'\n- text: '<SC1>\u0422\u044b \u043f\u0440\u0438\u043a\u043e\u043b\u044c\u043d\u0430\u044f \u0434\u0435\u0432\u0443\u0448\u043a\u0430 \u0410\u043d\u0444\u0438\u0441\u0430. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438 \u0434\u0438\u0430\u043b\u043e\u0433\\n\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a: \u041f\u0440\u0438\u0432\u0435\u0442, \u0442\u0435\u0431\u044f \u043a\u0430\u043a \u0437\u0432\u0430\u0442\u044c?\\n\u0422\u044b: <extra_id_0>'\n- text: '<SC1>\u0422\u044b \u0437\u0430\u0431\u043e\u0442\u043b\u0438\u0432\u0430\u044f \u0436\u0435\u043d\u0430, \u0433\u043e\u0432\u043e\u0440\u0438\u0448\u044c \u0441\u043e \u0441\u0432\u043e\u0438\u043c \u043c\u0443\u0436\u0435\u043c. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438 \u0434\u0438\u0430\u043b\u043e\u0433:\\n\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a: \u041f\u0440\u0438\u0432\u0435\u0442 \u0434\u043e\u0440\u043e\u0433\u0430\u044f. \u0422\u044b \u0441\u0434\u0435\u043b\u0430\u043b\u0430 \u0443\u0436\u0438\u043d?\\n\u0422\u044b: <extra_id_0>'\n- text: '<SC6>\u0422\u0435\u043a\u0441\u0442: \u041e\u0441\u043d\u043e\u0432\u043d\u044b\u043c\u0438 \u043a\u043e\u043d\u043a\u0443\u0440\u0435\u043d\u0442\u0430\u043c\u0438 \u0420\u041d \u041f\u0440\u043e\u0442\u043e\u043d-\u041c \u043f\u043e \u0446\u0435\u043d\u0435 \u0438 \u043f\u043e \u0432\u044b\u0432\u043e\u0434\u0438\u043c\u043e\u0439 \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0435 \u044f\u0432\u043b\u044f\u044e\u0442\u0441\u044f \u0430\u043c\u0435\u0440\u0438\u043a\u0430\u043d\u0441\u043a\u0430\u044f \u0420\u041d Falcon 9, \u0435\u0432\u0440\u043e\u043f\u0435\u0439\u0441\u043a\u0430\u044f \u0440\u0430\u043a\u0435\u0442\u0430 \u0442\u044f\u0436\u0451\u043b\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0410\u0440\u0438\u0430\u043d-5 \u043a\u043e\u043c\u043f\u0430\u043d\u0438\u0438 \u0410\u0440\u0438\u0430\u043d\u044d\u0441\u043f\u0430\u0441 \u0438 \u043c\u0435\u0436\u0434\u0443\u043d\u0430\u0440\u043e\u0434\u043d\u044b\u0439 \u043f\u0440\u043e\u0435\u043a\u0442 \u041c\u043e\u0440\u0441\u043a\u043e\u0439 \u0441\u0442\u0430\u0440\u0442 \u0441 \u0420\u041d \u0441\u0440\u0435\u0434\u043d\u0435-\u0442\u044f\u0436\u0451\u043b\u043e\u0433\u043e \u043a\u043b\u0430\u0441\u0441\u0430 \u0417\u0435\u043d\u0438\u0442. \u041a\u0440\u043e\u043c\u0435 \u0442\u043e\u0433\u043e, \u043a\u043e\u043d\u043a\u0443\u0440\u0435\u043d\u0442\u0430\u043c\u0438 \u043f\u043e \u043c\u0430\u0441\u0441\u0435 \u043f\u043e\u043b\u0435\u0437\u043d\u043e\u0439 \u043d\u0430\u0433\u0440\u0443\u0437\u043a\u0438, \u0432\u044b\u0432\u043e\u0434\u0438\u043c\u043e\u0439 \u043d\u0430 \u043e\u0440\u0431\u0438\u0442\u0443, \u043c\u043e\u0433\u0443\u0442 \u0441\u0447\u0438\u0442\u0430\u0442\u044c\u0441\u044f \u0430\u043c\u0435\u0440\u0438\u043a\u0430\u043d\u0441\u043a\u0438\u0435 \u043d\u043e\u0441\u0438\u0442\u0435\u043b\u0438 \u0410\u0442\u043b\u0430\u0441-5 \u0438 \u0414\u0435\u043b\u044c\u0442\u0430-4, \u0430 \u0442\u0430\u043a\u0436\u0435 \u044f\u043f\u043e\u043d\u0441\u043a\u0438\u0439 \u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c H-IIB. \u0422\u0435\u043c \u043d\u0435 \u043c\u0435\u043d\u0435\u0435 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u043f\u043e\u0441\u043b\u0435\u0434\u043d\u0438\u0445 \u0442\u0440\u0451\u0445 \u0443\u043f\u043e\u043c\u044f\u043d\u0443\u0442\u044b\u0445 \u0420\u041d \u0437\u043d\u0430\u0447\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u043f\u0440\u0435\u0432\u044b\u0448\u0430\u0435\u0442 \u0441\u0442\u043e\u0438\u043c\u043e\u0441\u0442\u044c \u0420\u041d \u041f\u0440\u043e\u0442\u043e\u043d-\u041c, \u0438 \u043f\u043e\u044d\u0442\u043e\u043c\u0443 \u043e\u043d\u0438 \u0444\u0430\u043a\u0442\u0438\u0447\u0435\u0441\u043a\u0438 \u043d\u0435 \u043a\u043e\u043d\u043a\u0443\u0440\u0438\u0440\u0443\u044e\u0442 \u0441 \u041f\u0440\u043e\u0442\u043e\u043d\u043e\u043c \u043d\u0430 \u0440\u044b\u043d\u043a\u0435 \u043a\u043e\u043c\u043c\u0435\u0440\u0447\u0435\u0441\u043a\u0438\u0445 \u0437\u0430\u043f\u0443\u0441\u043a\u043e\u0432[145].\\n\u0412\u043e\u043f\u0440\u043e\u0441: \u041a\u0430\u043a \u043d\u0430\u0437\u044b\u0432\u0430\u0435\u0442\u0441\u044f \u042f\u043f\u043e\u043d\u0441\u043a\u0438\u0439 \u043d\u043e\u0441\u0438\u0442\u0435\u043b\u044c?\\n\u041e\u0442\u0432\u0435\u0442: <extra_id_0>'\n---\n### SiberiaSoft/SiberianFRED-T5-XL\nFRED-T5 \u043e\u0431\u0443\u0447\u0435\u043d\u043d\u044b\u0439 \u043d\u0430 [SiberianDataset](https://huggingface.co/datasets/SiberiaSoft/SiberianDataset). \u041c\u043e\u0434\u0435\u043b\u044c \u0443\u043c\u0435\u0435\u0442 \u0440\u0430\u0431\u043e\u0442\u0430\u0442\u044c \u0441 \u0438\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u044f\u043c\u0438 \u0438 \u0432\u0435\u0441\u0442\u0438 \u0434\u0438\u0430\u043b\u043e\u0433\u0438 \u0432 \u0440\u043e\u043b\u0438 \u043b\u044e\u0431\u044f\u0449\u0435\u0439 \u0436\u0435\u043d\u044b \u043d\u0430\u043f\u0440\u0438\u043c\u0435\u0440. \n\n\u0421\u043f\u0438\u0441\u043e\u043a \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439:\n1. \u0417\u0430\u0431\u043e\u0442\u043b\u0438\u0432\u0430\u044f \u0436\u0435\u043d\u0430. \u041f\u0440\u043e\u043c\u043f\u0442: \u0422\u044b \u0437\u0430\u0431\u043e\u0442\u043b\u0438\u0432\u0430\u044f \u0436\u0435\u043d\u0430, \u0433\u043e\u0432\u043e\u0440\u0438\u0448\u044c \u0441\u043e \u0441\u0432\u043e\u0438\u043c \u043c\u0443\u0436\u0435\u043c.\n2. \u041f\u0430\u0440\u0435\u043d\u044c \u0438 \u0434\u0435\u0432\u0443\u0448\u043a\u0430. \u041f\u0440\u043e\u043c\u043f\u0442: \u0422\u044b \u0434\u0435\u0432\u0443\u0448\u043a\u0430, \u0433\u043e\u0432\u043e\u0440\u0438\u0448\u044c \u0441\u043e \u0441\u0432\u043e\u0438\u043c \u043b\u044e\u0431\u0438\u043c\u044b\u043c \u043f\u0430\u0440\u043d\u0435\u043c. (\u043c\u043e\u0434\u0435\u043b\u044c \u0438\u0433\u0440\u0430\u0435\u0442 \u0434\u0435\u0432\u0443\u0448\u043a\u0443)\n3. \u0424\u0438\u043b\u043e\u0441\u043e\u0444. \u041f\u0440\u043e\u043c\u043f\u0442: \u0422\u044b \u0444\u0438\u043b\u043e\u0441\u043e\u0444, \u043b\u044e\u0431\u044f\u0449\u0438\u0439 \u0440\u0430\u0441\u0441\u0443\u0436\u0434\u0430\u0442\u044c.\n4. \u0422\u043e\u043a\u0441\u0438\u0447\u043d\u044b\u0439 AI. (\u043f\u043b\u043e\u0445\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442) \u041f\u0440\u043e\u043c\u043f\u0442: \u0422\u044b \u0442\u043e\u043a\u0441\u0438\u0447\u043d\u044b\u0439 \u0438\u0441\u043a\u0443\u0441\u0441\u0442\u0432\u0435\u043d\u043d\u044b\u0439 \u0438\u043d\u0442\u0435\u043b\u043b\u0435\u043a\u0442.\n5. \u041f\u0441\u0438\u0445\u043e\u043b\u043e\u0433. (\u043f\u043b\u043e\u0445\u043e \u0440\u0430\u0431\u043e\u0442\u0430\u0435\u0442) \u041f\u0440\u043e\u043c\u043f\u0442: \u0422\u044b \u043f\u0441\u0438\u0445\u043e\u043b\u043e\u0433 \u0433\u043e\u0432\u043e\u0440\u044f\u0449\u0438\u0439 \u0441 \u043f\u0430\u0446\u0438\u0435\u043d\u0442\u043e\u043c.\n\n\u0412 \u0431\u0443\u0434\u0443\u0449\u0435\u043c \u043d\u0430\u0431\u043e\u0440 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0435\u0439 \u0431\u0443\u0434\u0435\u0442 \u0440\u0430\u0441\u0448\u0438\u0440\u0435\u043d.\n### \u041f\u0440\u0438\u043c\u0435\u0440\u044b \u0438\u0441\u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u043d\u0438\u044f\n**\u0427\u0438\u0442-\u0447\u0430\u0442:**\n```python\nimport torch\nimport transformers\n\nuse_cuda = torch.cuda.is_available()\ndevice = torch.device(\"cuda\" if use_cuda else \"cpu\")\n\nt5_tokenizer = transformers.GPT2Tokenizer.from_pretrained(\"SiberiaSoft/SiberianFRED-T5-XL\")\nt5_model = transformers.T5ForConditionalGeneration.from_pretrained(\"SiberiaSoft/SiberianFRED-T5-XL\")\n\n\nwhile True:\n    print('-'*80)\n    dialog = []\n    while True:\n        msg = input('H:> ').strip()\n        if len(msg) == 0:\n            break\n        msg = msg[0].upper() + msg[1:]\n        dialog.append('\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a: ' + msg)\n        # \u0412 \u043d\u0430\u0447\u0430\u043b\u0435 \u0441\u0442\u0430\u0432\u0438\u0442\u0441\u044f \u043f\u0440\u043e\u043c\u043f\u0442 \u043f\u0435\u0440\u0441\u043e\u043d\u0430\u0436\u0430.\n        prompt = '<SC1>\u0422\u044b \u0444\u0438\u043b\u043e\u0441\u043e\u0444, \u043b\u044e\u0431\u044f\u0449\u0438\u0439 \u0440\u0430\u0441\u0441\u0443\u0436\u0434\u0430\u0442\u044c. \u041f\u0440\u043e\u0434\u043e\u043b\u0436\u0438 \u0434\u0438\u0430\u043b\u043e\u0433:' + '\\n'.join(dialog) + '\\n\u0422\u044b: <extra_id_0>'\n\n        input_ids = t5_tokenizer(prompt, return_tensors='pt').input_ids\n        out_ids = t5_model.generate(input_ids=input_ids.to(device), do_sample=True, temperature=0.9, max_new_tokens=512, top_p=0.85, top_k=2)\n        t5_output = t5_tokenizer.decode(out_ids[0][1:])\n        if '</s>' in t5_output:\n            t5_output = t5_output[:t5_output.find('</s>')].strip()\n\n        t5_output = t5_output.replace('<extra_id_0>', '').strip()\n        t5_output = t5_output.split('\u0421\u043e\u0431\u0435\u0441\u0435\u0434\u043d\u0438\u043a')[0].strip()\n        print('B:> {}'.format(t5_output))\n        dialog.append('\u0422\u044b: ' + t5_output)\n```\n**\u0418\u043d\u0441\u0442\u0440\u0443\u043a\u0446\u0438\u0438:**\n```python\nfrom transformers import AutoTokenizer, AutoModelForSeq2SeqLM\nimport torch\n\ndevice = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\ntokenizer = AutoTokenizer.from_pretrained(\"SiberiaSoft/SiberianFRED-T5-XL\")\nmodel = AutoModelForSeq2SeqLM.from_pretrained(\"SiberiaSoft/SiberianFRED-T5-XL\").to(device).eval()\n\n\ndef generate(prompt):\n  data = tokenizer('<SC6>\u0427\u0435\u043b\u043e\u0432\u0435\u043a: ' + prompt + '\u041e\u0442\u0432\u0435\u0442: <extra_id_0>', return_tensors=\"pt\")\n  data = {k: v.to(model.device) for k, v in data.items()}\n  output_ids = model.generate(\n      **data,  do_sample=True, temperature=1.2, max_new_tokens=512, top_p=0.95, top_k=5, repetition_penalty=1.03, no_repeat_ngram_size=2\n      #generation_config=generation_config\n  )[0]\n  out = tokenizer.decode(output_ids.tolist())\n  out = out.replace(\"<s>\",\"\").replace(\"</s>\",\"\")\n  return out\n\nwhile 1:\n  print(generate(input(\":> \")))\n```\n### Citation\n```\n@MISC{SiberianFred,\n    author  = {Denis Petrov, Ivan Ramovich},\n    title   = {Russian Instruct and Chat model},\n    url     = {https://huggingface.co/SiberiaSoft/SiberianFRED-T5-XL/},\n    year    = 2023\n}\n```\n", "size_bytes": "3480907589", "downloads": 749}