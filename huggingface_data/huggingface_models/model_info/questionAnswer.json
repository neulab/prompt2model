{"pretrained_model_name": "ashishkat/questionAnswer", "description": "```\nfrom transformers import (\n    T5ForConditionalGeneration,\n    T5Tokenizer\n)\n\nimport pandas as pd\nimport numpy as np\n\ntokenizer = T5Tokenizer.from_pretrained(\"ashishkat/questionAnswer\")\nmodel = T5ForConditionalGeneration.from_pretrained(\"ashishkat/questionAnswer\", return_dict=True)\n\n\ndef generate_answer(question, context):\n    \"\"\"Function gives the answer to the  question asked, given context\n\n    question(str) : question asked by user\n    context(str): Paragraph given by used \n\n    Returns:\n        string: Answer to respective question asked\n    \"\"\"\n\n    ## tokenizeing question + context at a same time \n    ## max length is 512, greater are removed, less are padded\n    source_encoding = tokenizer(\n            question,\n            context,\n            max_length = 512,  \n            padding=\"max_length\",\n            truncation=\"only_second\",\n            return_attention_mask = True,\n            return_tensors=\"pt\",\n            add_special_tokens=True\n            )\n    ## generating answer from model\n    generate_ids = model.generate(\n           input_ids = source_encoding[\"input_ids\"],\n           attention_mask = source_encoding[\"attention_mask\"],\n           max_length = 30,\n           use_cache=True,\n       )\n\n    ## decoding the tokenized prediction\n    pred = [\n               tokenizer.decode(ids, skip_special_tokens=True) for ids in generate_ids\n       ]\n\n    return \" \".join(pred)  ## returns the predicted string as answer\n\n\n\n\ncontext = \"The Normans (Norman: Nourmands; French: Normands; Latin: Normanni) were the people who \\\n        in the 10th and 11th centuries gave their name to Normandy, a region in France. They were\\\n        descended from Norse (\\\"Norman\\\" comes from \\\"Norseman\\\") raiders and pirates from Denmark,\\\n        Iceland and Norway who, under their leader Rollo, agreed to swear fealty to King Charles III\\\n        of West Francia. Through generations of assimilation and mixing with the native Frankish and\\\n        Roman-Gaulish populations, their descendants would gradually merge with the Carolingian-based\\\n        cultures of West Francia. The distinct cultural and ethnic identity of the Normans emerged initially\\\n        in the first half of the 10th century, and it continued to evolve over the succeeding centuries.\"\n\nquestion = \"From which countries did the Norse originate?\"\n# question = \"Who was the Norse leader?\" \"rollo\"\n# actual_answer = \"Denmark, Iceland and Norway\"\nanswer = generate_answer(context, question)\nprint(answer)\n```", "size_bytes": "891700799", "downloads": 225}