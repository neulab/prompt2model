{"pretrained_model_name": "uer/t5-small-chinese-cluecorpussmall", "description": "---\nlanguage: zh\ndatasets: CLUECorpusSmall\nwidget: \n- text: \"\u4f5c\u4e3a\u7535\u5b50extra0\u7684\u5e73\u53f0\uff0c\u4eac\u4e1c\u7edd\u5bf9\u662f\u9886\u5148\u8005\u3002\u5982\u4eca\u7684\u5218\u5f3aextra1\u5df2\u7ecf\u662f\u8eab\u4ef7\u8fc7extra2\u7684\u8001\u677f\u3002\"\n\n\n---\n\n\n# Chinese T5\n\n## Model description\n\nThis is the set of Chinese T5 models pre-trained by [UER-py](https://github.com/dbiir/UER-py/), which is introduced in [this paper](https://arxiv.org/abs/1909.05658).\n\nThe Text-to-Text Transfer Transformer (T5) leverages a unified text-to-text format and attains state-of-the-art results on a wide variety of English-language NLP tasks. Following their work, we released a series of Chinese T5 models.\n\nYou can download the set of Chinese T5 models either from the [UER-py Modelzoo page](https://github.com/dbiir/UER-py/wiki/Modelzoo), or via HuggingFace from the links below:\n\n|          |           Link           |\n| -------- | :-----------------------: |\n| **T5-Small**  | [**L=6/H=512 (Small)**][small] |\n| **T5-Base**  | [**L=12/H=768 (Base)**][base] |\n\nIn T5, spans of the input sequence are masked by so-called sentinel token. Each sentinel token represents a unique mask token for the input sequence and should start with `<extra_id_0>`, `<extra_id_1>`, \u2026 up to `<extra_id_99>`. However, `<extra_id_xxx>` is separated into multiple parts in Huggingface's Hosted inference API. Therefore, we replace `<extra_id_xxx>` with `extraxxx` in vocabulary and BertTokenizer regards `extraxxx` as one sentinel token.\n\n## How to use\n\nYou can use this model directly with a pipeline for text2text generation (take the case of T5-Small):\n\n```python\n>>> from transformers import BertTokenizer, T5ForConditionalGeneration, Text2TextGenerationPipeline\n>>> tokenizer = BertTokenizer.from_pretrained(\"uer/t5-small-chinese-cluecorpussmall\")\n>>> model = T5ForConditionalGeneration.from_pretrained(\"uer/t5-small-chinese-cluecorpussmall\")\n>>> text2text_generator = Text2TextGenerationPipeline(model, tokenizer)  \n>>> text2text_generator(\"\u4e2d\u56fd\u7684\u9996\u90fd\u662fextra0\u4eac\", max_length=50, do_sample=False)\n    [{'generated_text': 'extra0 \u5317 extra1 extra2 extra3 extra4 extra5'}]\n```\n\n## Training data\n\n[CLUECorpusSmall](https://github.com/CLUEbenchmark/CLUECorpus2020/) is used as training data. \n\n## Training procedure\n\nThe model is pre-trained by [UER-py](https://github.com/dbiir/UER-py/) on [Tencent Cloud](https://cloud.tencent.com/). We pre-train 1,000,000 steps with a sequence length of 128 and then pre-train 250,000 additional steps with a sequence length of 512. We use the same hyper-parameters on different model sizes.\n\nTaking the case of T5-Small\n\nStage1:\n\n```\npython3 preprocess.py --corpus_path corpora/cluecorpussmall.txt \\\n                      --vocab_path models/google_zh_with_sentinel_vocab.txt \\\n                      --dataset_path cluecorpussmall_t5_seq128_dataset.pt \\\n                      --processes_num 32 --seq_length 128 \\\n                      --dynamic_masking --data_processor t5 \n```\n\n```\npython3 pretrain.py --dataset_path cluecorpussmall_t5_seq128_dataset.pt \\\n                    --vocab_path models/google_zh_with_sentinel_vocab.txt \\\n                    --config_path models/t5/small_config.json \\\n                    --output_model_path models/cluecorpussmall_t5_small_seq128_model.bin \\\n                    --world_size 8 --gpu_ranks 0 1 2 3 4 5 6 7 \\\n                    --total_steps 1000000 --save_checkpoint_steps 100000 --report_steps 50000 \\\n                    --learning_rate 1e-3 --batch_size 64 \\\n                    --span_masking --span_geo_prob 0.3 --span_max_length 5\n\n```\n\nStage2:\n\n```\npython3 preprocess.py --corpus_path corpora/cluecorpussmall.txt \\\n                      --vocab_path models/google_zh_with_sentinel_vocab.txt \\\n                      --dataset_path cluecorpussmall_t5_small_seq512_dataset.pt \\\n                      --processes_num 32 --seq_length 512 \\\n                      --dynamic_masking --data_processor t5\n```\n\n```\npython3 pretrain.py --dataset_path cluecorpussmall_t5_seq512_dataset.pt \\\n                    --vocab_path models/google_zh_with_sentinel_vocab.txt \\\n                    --pretrained_model_path models/cluecorpussmall_t5_small_seq128_model.bin-1000000 \\\n                    --config_path models/t5/small_config.json \\\n                    --output_model_path models/cluecorpussmall_t5_small_seq512_model.bin \\\n                    --world_size 8 --gpu_ranks 0 1 2 3 4 5 6 7 \\\n                    --total_steps 250000 --save_checkpoint_steps 50000 --report_steps 10000 \\\n                    --learning_rate 5e-4 --batch_size 16 \\\n                    --span_masking --span_geo_prob 0.3 --span_max_length 5\n```\n\nFinally, we convert the pre-trained model into Huggingface's format:\n\n```\npython3 scripts/convert_t5_from_uer_to_huggingface.py --input_model_path cluecorpussmall_t5_small_seq512_model.bin-250000 \\\n                                                      --output_model_path pytorch_model.bin \\\n                                                      --layers_num 6 \\\n                                                      --type t5\n```\n\n\n### BibTeX entry and citation info\n\n```\n@article{2020t5,\n  title   = {Exploring the Limits of Transfer Learning with a Unified Text-to-Text Transformer},\n  author  = {Colin Raffel and Noam Shazeer and Adam Roberts and Katherine Lee and Sharan Narang and Michael Matena and Yanqi Zhou and Wei Li and Peter J. Liu},\n  journal = {Journal of Machine Learning Research},\n  pages   = {1-67},\n  year    = {2020}\n}\n\n@article{zhao2019uer,\n  title={UER: An Open-Source Toolkit for Pre-training Models},\n  author={Zhao, Zhe and Chen, Hui and Zhang, Jinbin and Zhao, Xin and Liu, Tao and Lu, Wei and Chen, Xi and Deng, Haotang and Ju, Qi and Du, Xiaoyong},\n  journal={EMNLP-IJCNLP 2019},\n  pages={241},\n  year={2019}\n}\n```\n\n[small]:https://huggingface.co/uer/t5-small-chinese-cluecorpussmall\n[base]:https://huggingface.co/uer/t5-base-chinese-cluecorpussmall", "size_bytes": "219764039", "downloads": 192}