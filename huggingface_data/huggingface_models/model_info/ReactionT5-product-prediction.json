{"pretrained_model_name": "sagawa/ReactionT5-product-prediction", "description": "---\nlanguage:\n- en\nlicense: mit\ntags:\n- chemistry\n- SMILES\n- product\ndatasets:\n- ORD\nmetrics:\n- accuracy\n---\n\n# Model Card for ReactionT5-product-prediction\n\nThis is a ReactionT5 pre-trained to predict the products of reactions. You can use the demo [here](https://huggingface.co/spaces/sagawa/predictproduct-t5).\n\n## Model Details\n\n<!-- Provide a longer summary of what this model is. -->\n\n\n### Model Sources\n\n<!-- Provide the basic links for the model. -->\n\n- **Repository:** https://github.com/sagawatatsuya/ReactionT5\n- **Paper:** {{ paper | default(\"[More Information Needed]\", true)}}\n- **Demo:** https://huggingface.co/spaces/sagawa/predictproduct-t5\n\n## Uses\n\n<!-- Address questions around how the model is intended to be used, including the foreseeable users of the model and those affected by the model. -->\n\n## How to Get Started with the Model\n\nDownload files and use the code below to get started with the model.\n\n```python\nfrom transformers import AutoTokenizer, T5ForConditionalGeneration\n\ntokenizer = AutoTokenizer.from_pretrained('sagawa/ReactionT5-product-prediction')\ninp = tokenizer('REACTANT:COC(=O)C1=CCCN(C)C1.O.[Al+3].[H-].[Li+].[Na+].[OH-]REAGENT:C1CCOC1', return_tensors='pt')\nmodel = T5ForConditionalGeneration.from_pretrained('sagawa/ReactionT5-product-prediction')\noutput = model.generate(**inp, min_length=6, max_length=109, num_beams=1, num_return_sequences=1, return_dict_in_generate=True, output_scores=True)\noutput = tokenizer.decode(output['sequences'][0], skip_special_tokens=True).replace(' ', '').rstrip('.')\noutput # 'O=S(=O)([O-])[O-].O=S(=O)([O-])[O-].O=S(=O)([O-])[O-].[Cr+3].[Cr+3]'\n```\n\n## Training Details\n\n### Training Procedure \n\n<!-- This relates heavily to the Technical Specifications. Content here should link to that section when it is relevant to the training procedure. -->\nWe used Open Reaction Database (ORD) dataset for model training.\nFollowing is the command used for training. For more information, please refer to the paper and GitHub repository.\n\n```python\npython train.py \\\n    --epochs=100 \\\n    --batch_size=32 \\\n    --data_path='../data/all_ord_reaction_uniq_with_attr_v3.csv' \\\n    --use_reconstructed_data \\\n    --pretrained_model_name_or_path='sagawa/CompoundT5'\n```\n\n### Results\n\n\n| Model                | Training set              | Test set | Top-1 [% acc.] | Top-2 [% acc.] | Top-3 [% acc.] | Top-5 [% acc.] |\n|----------------------|---------------------------|----------|----------------|----------------|----------------|----------------|\n| Sequence-to-sequence | USPTO                     | USPTO    | 80.3           | 84.7           | 86.2           | 87.5           |\n| WLDN                 | USPTO                     | USPTO    | 80.6 (85.6)    | 90.5           | 92.8           | 93.4           |\n| Molecular Transformer| USPTO                     | USPTO    | 88.8           | 92.6           | \u2013              | 94.4           |\n| T5Chem               | USPTO                     | USPTO    | 90.4           | 94.2           | \u2013              | 96.4           |\n| CompoundT5           | USPTO                     | USPTO    | 88.0           | 92.4           | 93.9           | 95.0           |\n| ReactionT5           | ORD                       | USPTO    | 0.0 <85.0>     | 0.0 <90.6>     | 0.0 <92.3>     | 0.0 <93.8>     |\n\nPerformance comparison of Compound T5, ReactionT5, and other models in product prediction. The values enclosed in \u2018<>\u2019 in the table represent the scores of the model that was fine-tuned on 200 reactions from the USPTO dataset. The score enclosed in \u2018()\u2019 is the one reported in the original paper. \n\n## Citation [optional]\n\n<!-- If there is a paper or blog post introducing the model, the APA and Bibtex information for that should go in this section. -->\n\n\n## Model Card Authors [optional]\n\n{{ model_card_authors | default(\"[More Information Needed]\", true)}}\n\n## Model Card Contact\n\n{{ model_card_contact | default(\"[More Information Needed]\", true)}}", "size_bytes": "794658765", "downloads": 60}