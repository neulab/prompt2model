{"pretrained_model_name": "marefa-nlp/summarization-arabic-english-news", "description": "------------\n## Arabic and English News Summarization NLP Model\n\n### About\n\nThis model is for summarizing news stories in short highlights for both Arabic and English tasks.\n\n\u0646\u0645\u0648\u0630\u062c \u0645\u0639\u0631\u0641\u064a \u0645\u062a\u062e\u0635\u0635 \u0641\u064a \u062a\u0644\u062e\u064a\u0635 \u0627\u0644\u0623\u062e\u0628\u0627\u0631 \u0627\u0644\u0639\u0631\u0628\u064a\u0629 \u0648 \u0627\u0644\u0625\u0646\u062c\u0644\u064a\u0632\u064a\u0629 \u0627\u0644\u0649 \u0645\u062c\u0645\u0648\u0639\u0629 \u0645\u0646 \u0623\u0647\u0645 \u0627\u0644\u0646\u0642\u0627\u0637\n\n### Fine-Tuning\n\nThe model was finetuned using the [Arabic T5 Model](https://huggingface.co/bakrianoo/t5-arabic-large) which developed by [Abu Bakr Soliman](http://github.com/bakrianoo).\n\nThe primary summarization model also developed by the same developer.\n\n### How to Use\n\n- You can use this [Colab Notebook](https://colab.research.google.com/drive/1DWND1CAfCXD4OxrfmLBEaKeXhjGmYkod?usp=sharing) to test the model\n\n1. Install [PyTorch](https://pytorch.org/)\n\n2. Install the following Python packages\n\n`$ pip3 install transformers==4.7.0 nltk==3.5 protobuf==3.15.3 sentencepiece==0.1.96`\n\n3. Run this code\n\n```python\n\nfrom transformers import AutoTokenizer, AutoModelWithLMHead\nimport torch\nimport nltk\nnltk.download('punkt')\nfrom nltk.tokenize import sent_tokenize\n\ndevice = torch.device(\"cuda:0\" if torch.cuda.is_available() else \"cpu\")\nm_name = \"marefa-nlp/summarization-arabic-english-news\"\n\ntokenizer = AutoTokenizer.from_pretrained(m_name)\nmodel = AutoModelWithLMHead.from_pretrained(m_name).to(device)\n\ndef get_summary(text, tokenizer, model, device=\"cpu\", num_beams=2):\n    if len(text.strip()) < 50:\n        return [\"Please provide more longer text\"]\n    \n    text = \"summarize: <paragraph> \" + \" <paragraph> \".join([ s.strip() for s in sent_tokenize(text) if s.strip() != \"\"]) + \" </s>\"\n    text = text.strip().replace(\"\\n\",\"\")\n    \n    tokenized_text = tokenizer.encode(text, return_tensors=\"pt\").to(device)\n    \n    summary_ids = model.generate(\n            tokenized_text,\n            max_length=512,\n            num_beams=num_beams,\n            repetition_penalty=1.5, \n            length_penalty=1.0, \n            early_stopping=True\n    )\n    \n    output = tokenizer.decode(summary_ids[0], skip_special_tokens=True)\n    return [ s.strip() for s in output.split(\"<hl>\") if s.strip() != \"\" ]\n    \n## Prepare Samples\n\nsamples = [\n    \"\"\"\n        \u0642\u0627\u0644 \u0627\u0644\u0645\u062f\u0627\u0641\u0639 \u0627\u0644\u0625\u064a\u0637\u0627\u0644\u064a \u0644\u064a\u0648\u0646\u0627\u0631\u062f\u0648 \u0628\u0648\u0646\u0648\u062a\u0634\u064a \u0625\u0646 \u0645\u0646\u062a\u062e\u0628 \u0628\u0644\u0627\u062f\u0647 \u0644\u064a\u0633 \u062e\u0627\u0626\u0641\u0627 \u0645\u0646 \u0645\u0648\u0627\u062c\u0647\u0629 \u0646\u0638\u064a\u0631\u0647 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u0639\u0644\u0649 \u0623\u0631\u0636\u0647 \u0641\u064a \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0627\u0644\u0646\u0647\u0627\u0626\u064a\u0629 \u0641\u064a \u0628\u0637\u0648\u0644\u0629 \u064a\u0648\u0631\u0648 2020 \u0644\u0643\u0631\u0629 \u0627\u0644\u0642\u062f\u0645\u060c \u0641\u064a \u062d\u064a\u0646 \u0648\u0635\u0641 \u0627\u0644\u0645\u062f\u0627\u0641\u0639 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u062c\u0648\u0646 \u0633\u062a\u0648\u0646\u0632 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0627\u0644\u0645\u0631\u062a\u0642\u0628\u0629 \u0628\u0623\u0646\u0647\u0627 \u0633\u062a\u0643\u0648\u0646 \"\u0623\u0643\u062b\u0631 \u062a\u0645\u064a\u0632\u0627\".\n        \u0648\u0633\u0648\u0641 \u062a\u0642\u0627\u0645 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0641\u064a \u0627\u0633\u062a\u0627\u062f \u0648\u064a\u0645\u0628\u0644\u064a\u060c \u0634\u0645\u0627\u0644 \u063a\u0631\u0628\u064a \u0644\u0646\u062f\u0646\u060c \u064a\u0648\u0645 \u0627\u0644\u0623\u062d\u062f.\n        \u0648\u062a\u0633\u0639\u0649 \u0625\u064a\u0637\u0627\u0644\u064a\u0627 \u0644\u0625\u062d\u0631\u0627\u0632 \u0627\u0644\u0644\u0642\u0628 \u0627\u0644\u0623\u0648\u0631\u0648\u0628\u064a \u0644\u0644\u0645\u0631\u0629 \u0627\u0644\u062b\u0627\u0646\u064a\u0629 \u0628\u0639\u062f \u0641\u0648\u0632\u0647\u0627 \u0628\u0647 \u0623\u0648\u0644 \u0645\u0631\u0629 \u0639\u0627\u0645 1968.\n        \u0648\u0644\u0645 \u064a\u0641\u0632 \u0627\u0644\u0641\u0631\u064a\u0642 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u0628\u0647\u0630\u0627 \u0627\u0644\u0644\u0642\u0628 \u0627\u0644\u0642\u0627\u0631\u064a \u0645\u0646 \u0642\u0628\u0644. \u0648\u0627\u0644\u0628\u0637\u0648\u0644\u0629 \u0627\u0644\u0631\u0626\u064a\u0633\u064a\u0629 \u0627\u0644\u0648\u062d\u064a\u062f\u0629 \u0627\u0644\u062a\u064a \u0641\u0627\u0632\u062a \u0628\u0647\u0627 \u0627\u0646\u062c\u0644\u062a\u0631\u0627 \u0647\u064a \u0643\u0623\u0633 \u0627\u0644\u0639\u0627\u0644\u0645 \u0639\u0627\u0645 1966 \u0627\u0644\u0630\u064a \u0623\u0642\u064a\u0645\u062a \u0645\u0628\u0627\u0631\u0627\u062a\u0647 \u0627\u0644\u0646\u0647\u0627\u0626\u064a\u0629 \u0641\u064a \u0627\u0633\u062a\u0627\u062f \u0648\u064a\u0645\u0628\u0644\u064a.\n    \"\"\",\n    \n    \"\"\"\n        On a night fraught with tension, Italy clinched its first major title for 15 years with a penalty shootout win over England in the Euro 2020 final.\n        Luke Shaw's goal inside the opening two minutes gave England a lead it looked like it would hold onto all night, before a goalmouth scramble midway through the second half allowed Leonardo Bonucci to poke home an equalizer for Italy.\n        For the remainder of the match, it felt as though extra-time and penalties were inevitable, as neither side seemed willing or brave enough to commit enough men forward to really trouble the opposing defenders.\n        England had suffered innumerable heartbreaks on penalties over the years and this time it was Italy's turn to inflict yet more pain on beleaguered English fans as Marcus Rashford, Jadon Sancho and Bukayo Saka all missed from the spot.\n    \"\"\",\n]\n\n## Get summaries\n\nprint(\"Original Article:\", samples[0])\nprint(\"\\n===========\\nSummary: \\n\")\nhls = get_summary(samples[0], tokenizer, model, device)\nfor hl in hls:\n    print(\"\\t-\", hl)\n    \n    \nprint(\"Original Article:\", samples[1])\nprint(\"\\n=========== \\nSummary: \\n\")\nhls = get_summary(samples[1], tokenizer, model, device)\nfor hl in hls:\n    print(\"\\t-\", hl)\n```\n\nResults\n\n```\nOriginal Article: \n\n        \u0642\u0627\u0644 \u0627\u0644\u0645\u062f\u0627\u0641\u0639 \u0627\u0644\u0625\u064a\u0637\u0627\u0644\u064a \u0644\u064a\u0648\u0646\u0627\u0631\u062f\u0648 \u0628\u0648\u0646\u0648\u062a\u0634\u064a \u0625\u0646 \u0645\u0646\u062a\u062e\u0628 \u0628\u0644\u0627\u062f\u0647 \u0644\u064a\u0633 \u062e\u0627\u0626\u0641\u0627 \u0645\u0646 \u0645\u0648\u0627\u062c\u0647\u0629 \u0646\u0638\u064a\u0631\u0647 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u0639\u0644\u0649 \u0623\u0631\u0636\u0647 \u0641\u064a \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0627\u0644\u0646\u0647\u0627\u0626\u064a\u0629 \u0641\u064a \u0628\u0637\u0648\u0644\u0629 \u064a\u0648\u0631\u0648 2020 \u0644\u0643\u0631\u0629 \u0627\u0644\u0642\u062f\u0645\u060c \u0641\u064a \u062d\u064a\u0646 \u0648\u0635\u0641 \u0627\u0644\u0645\u062f\u0627\u0641\u0639 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u062c\u0648\u0646 \u0633\u062a\u0648\u0646\u0632 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0627\u0644\u0645\u0631\u062a\u0642\u0628\u0629 \u0628\u0623\u0646\u0647\u0627 \u0633\u062a\u0643\u0648\u0646 \"\u0623\u0643\u062b\u0631 \u062a\u0645\u064a\u0632\u0627\".\n        \u0648\u0633\u0648\u0641 \u062a\u0642\u0627\u0645 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0641\u064a \u0627\u0633\u062a\u0627\u062f \u0648\u064a\u0645\u0628\u0644\u064a\u060c \u0634\u0645\u0627\u0644 \u063a\u0631\u0628\u064a \u0644\u0646\u062f\u0646\u060c \u064a\u0648\u0645 \u0627\u0644\u0623\u062d\u062f.\n        \u0648\u062a\u0633\u0639\u0649 \u0625\u064a\u0637\u0627\u0644\u064a\u0627 \u0644\u0625\u062d\u0631\u0627\u0632 \u0627\u0644\u0644\u0642\u0628 \u0627\u0644\u0623\u0648\u0631\u0648\u0628\u064a \u0644\u0644\u0645\u0631\u0629 \u0627\u0644\u062b\u0627\u0646\u064a\u0629 \u0628\u0639\u062f \u0641\u0648\u0632\u0647\u0627 \u0628\u0647 \u0623\u0648\u0644 \u0645\u0631\u0629 \u0639\u0627\u0645 1968.\n        \u0648\u0644\u0645 \u064a\u0641\u0632 \u0627\u0644\u0641\u0631\u064a\u0642 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u0628\u0647\u0630\u0627 \u0627\u0644\u0644\u0642\u0628 \u0627\u0644\u0642\u0627\u0631\u064a \u0645\u0646 \u0642\u0628\u0644. \u0648\u0627\u0644\u0628\u0637\u0648\u0644\u0629 \u0627\u0644\u0631\u0626\u064a\u0633\u064a\u0629 \u0627\u0644\u0648\u062d\u064a\u062f\u0629 \u0627\u0644\u062a\u064a \u0641\u0627\u0632\u062a \u0628\u0647\u0627 \u0627\u0646\u062c\u0644\u062a\u0631\u0627 \u0647\u064a \u0643\u0623\u0633 \u0627\u0644\u0639\u0627\u0644\u0645 \u0639\u0627\u0645 1966 \u0627\u0644\u0630\u064a \u0623\u0642\u064a\u0645\u062a \u0645\u0628\u0627\u0631\u0627\u062a\u0647 \u0627\u0644\u0646\u0647\u0627\u0626\u064a\u0629 \u0641\u064a \u0627\u0633\u062a\u0627\u062f \u0648\u064a\u0645\u0628\u0644\u064a.\n    \n\n===========\nSummary: \n\n\t- \u0648\u0633\u0648\u0641 \u062a\u0648\u0627\u062c\u0647 \u0625\u064a\u0637\u0627\u0644\u064a\u0627 \u0625\u0646\u062c\u0644\u062a\u0631\u0627 \u0641\u064a \u0628\u0637\u0648\u0644\u0629 \u064a\u0648\u0631\u0648 2020 \u0644\u0643\u0631\u0629 \u0627\u0644\u0642\u062f\u0645 \u064a\u0648\u0645 \u0627\u0644\u0623\u062d\u062f.\n\t- \u0633\u062a\u0642\u0627\u0645 \u0627\u0644\u0645\u0628\u0627\u0631\u0627\u0629 \u0641\u064a \u0627\u0633\u062a\u0627\u062f \u0648\u064a\u0645\u0628\u0644\u064a\u060c \u0634\u0645\u0627\u0644 \u063a\u0631\u0628\u064a \u0644\u0646\u062f\u0646\u060c \u064a\u0648\u0645 \u0627\u0644\u0623\u062d\u062f.\n\t- \u0648\u0644\u0645 \u064a\u0641\u0632 \u0627\u0644\u0641\u0631\u064a\u0642 \u0627\u0644\u0627\u0646\u062c\u0644\u064a\u0632\u064a \u0628\u0647\u0630\u0627 \u0627\u0644\u0644\u0642\u0628 \u0627\u0644\u0642\u0627\u0631\u064a \u0642\u0628\u0644.\n\t\n```\n\n```\nOriginal Article: \n\n        On a night fraught with tension, Italy clinched its first major title for 15 years with a penalty shootout win over England in the Euro 2020 final.\n        Luke Shaw's goal inside the opening two minutes gave England a lead it looked like it would hold onto all night, before a goalmouth scramble midway through the second half allowed Leonardo Bonucci to poke home an equalizer for Italy.\n        For the remainder of the match it felt as though extra-time and penalties were inevitable, as neither side seemed willing or brave enough to commit enough men forward to really trouble the opposing defenders.\n        England had suffered innumerable heartbreaks on penalties over the years and this time it was Italy's turn to inflict yet more pain on beleaguered English fans as Marcus Rashford, Jadon Sancho and Bukayo Saka all missed from the spot.\n    \n\n=========== \nSummary: \n\n\t- Luke Shaw's goal gave England a lead it looked like it would hold onto all night.\n\t- Leonardo Bonucci scored the equalizer for Italy.\n\t- Marcus Rashford, Jadon Sancho and Bukayo Saka all missed.\n```\n", "size_bytes": "3156380325", "downloads": 115}