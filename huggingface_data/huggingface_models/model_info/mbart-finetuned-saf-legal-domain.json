{"pretrained_model_name": "Short-Answer-Feedback/mbart-finetuned-saf-legal-domain", "description": "---\nlanguage: de\ndatasets:\n- Short-Answer-Feedback/saf_legal_domain_german\ntags:\n- generated_from_trainer\nwidget:\n- text: \"Antwort: Wird sich nicht an die Auflagen gehalten (unzureichende Eigenbem\u00fchung), droht eine Sperrzeit von 1-2 Wochen. Dadurch wird f\u00fcr die genannte zeit keine Leistung gezahlt, die Anspruchsdauer vermindert sich insgesamt. Bei wichtigen Gr\u00fcnden wird die Sperrzeit nicht verordnet. L\u00f6sung: Merkblatt 1 f\u00fcr Arbeitslose, S. 22: Erbringen Sie die Pflichten im Zusammenhang mit den Eigenbem\u00fchungen nicht, nicht rechtzeitig oder nicht vollst\u00e4ndig, tritt eine Sperrzeit (0,75 p) ein. Merkblatt 1 f\u00fcr Arbeitslose, S. 55: Die Dauer einer Sperrzeit bei unzureichenden Eigenbem\u00fchungen betr\u00e4gt zwei Wochen. (0,25 p). Frage: Mit welcher Folge und welcher Dauer m\u00fcssen Sie rechnen, wenn Sie Ihre notwendigen Eigenbem\u00fchungen nicht rechtzeitig oder nicht vollst\u00e4ndig erf\u00fcllen?\"\n---\n\n# mbart-finetuned-saf-legal-domain\n\nThis model is a fine-tuned version of [facebook/mbart-large-cc25](https://huggingface.co/facebook/mbart-large-cc25) on the [saf_legal_domain_german](https://huggingface.co/datasets/Short-Answer-Feedback/saf_legal_domain_german) dataset for Short Answer Feedback (SAF).\n\n## Model description\n\nThis model was built on top of [mBART](https://arxiv.org/abs/2001.08210), which is a sequence-to-sequence denoising auto-encoder pre-trained on large-scale monolingual corpora in many languages.\n\nIt expects inputs in the following format:\n```\nAntwort: [answer] L\u00f6sung: [reference_answer] Frage: [question]\n```\n\nIn the example above, `[answer]`, `[reference_answer]` and `[question]` should be replaced by the provided answer, the reference answer and the question to which they refer, respectively.\n\n\nThe outputs are formatted as follows:\n```\n[verification_feedback] Feedback: [feedback]\n```\n\nHence, the `[verification_feedback]` label will be one of `Correct`, `Partially correct` or `Incorrect`, while `[feedback]` will be the textual feedback generated by the model according to the given answer.\n\n## Intended uses & limitations\n\nThis model is intended to be used for Short Answer Feedback generation in the domain of the German social law. Thus, it is not expected to have particularly good performance on sets of questions and answers out of this scope.\n\nIt is important to acknowledge that the model underperforms when a question that was not seen during training is given as input for inference. In particular, it tends to classify most answers as being correct and does not provide relevant feedback in such cases. Nevertheless, this limitation could be partially overcome by extending the dataset with the desired question (and associated answers) and fine-tuning it for a few epochs on the new data.\n\n## Training and evaluation data\n\nAs mentioned previously, the model was trained on the [saf_legal_domain_german](https://huggingface.co/datasets/Short-Answer-Feedback/saf_legal_domain_german) dataset, which is divided into the following splits.\n\n| Split                 | Number of examples |\n| --------------------- | ------------------ |\n| train                 | 1596\t             |\n| validation            | 400\t             |\n| test_unseen_answers   | 221\t             |\n| test_unseen_questions | 275                |\n\nEvaluation was performed on the `test_unseen_answers` and `test_unseen_questions` splits.\n\n## Training procedure\n\nThe [Trainer API](https://huggingface.co/docs/transformers/main_classes/trainer#transformers.Seq2SeqTrainer) was used to fine-tune the model. The code utilized for pre-processing and training was mostly adapted from the [summarization script](https://github.com/huggingface/transformers/tree/main/examples/pytorch/summarization) made available by HuggingFace.\n\nTraining was completed in a little over 1 hour on a GPU on Google Colab.\n\n### Training hyperparameters\n\nThe following hyperparameters were used during training:\n- num_epochs: 9\n- optimizer: Adam with betas=(0.9,0.999) and epsilon=1e-08\n- learning_rate: 5e-05\n- lr_scheduler_type: linear\n- train_batch_size: 1\n- gradient_accumulation_steps: 4\n- eval_batch_size: 4\n- mixed_precision_training: Native AMP\n- seed: 42\n\n### Framework versions\n\n- Transformers 4.25.1\n- Pytorch 1.13.0+cu116\n- Datasets 2.7.1\n- Tokenizers 0.13.2\n\n## Evaluation results\n\nThe generated feedback was evaluated through means of the [SacreBLEU](https://huggingface.co/spaces/evaluate-metric/sacrebleu), [ROUGE-2](https://huggingface.co/spaces/evaluate-metric/rouge), [METEOR](https://huggingface.co/spaces/evaluate-metric/meteor), [BERTScore](https://huggingface.co/spaces/evaluate-metric/bertscore) metrics from HuggingFace, while the [accuracy](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.accuracy_score.html) and [F1](https://scikit-learn.org/stable/modules/generated/sklearn.metrics.f1_score.html) scores from scikit-learn were used for evaluation of the labels.\n\nThe following results were achieved.\n\n| Split                 | SacreBLEU | ROUGE-2 | METEOR | BERTScore | Accuracy | Weighted F1 | Macro F1 | \n| --------------------- | :-------: | :-----: | :----: | :-------: | :------: | :---------: | :------: |\n| test_unseen_answers   | 42.8\t    | 43.7    | 58.2   | 57.5      | 81.0     | 80.1        | 74.6     |\n| test_unseen_questions | 3.2       | 5.0     | 20.0   | 14.8      | 60.7     | 55.3        | 55.4     |\n\n\nThe script used to compute these metrics and perform evaluation can be found in the `evaluation.py` file in this repository.\n\n## Usage\n\nThe example below shows how the model can be applied to generate feedback to a given answer.\n\n```python\nfrom transformers import AutoModelForSeq2SeqLM, AutoTokenizer\n\nmodel = AutoModelForSeq2SeqLM.from_pretrained('Short-Answer-Feedback/mbart-finetuned-saf-legal-domain')\ntokenizer = AutoTokenizer.from_pretrained('Short-Answer-Feedback/mbart-finetuned-saf-legal-domain')\n\nexample_input = 'Antwort: Wird sich nicht an die Auflagen gehalten (unzureichende Eigenbem\u00fchung), droht eine Sperrzeit von 1-2 Wochen. Dadurch wird f\u00fcr die genannte zeit keine Leistung gezahlt, die Anspruchsdauer vermindert sich insgesamt. Bei wichtigen Gr\u00fcnden wird die Sperrzeit nicht verordnet. L\u00f6sung: Merkblatt 1 f\u00fcr Arbeitslose, S. 22: Erbringen Sie die Pflichten im Zusammenhang mit den Eigenbem\u00fchungen nicht, nicht rechtzeitig oder nicht vollst\u00e4ndig, tritt eine Sperrzeit (0,75 p) ein. Merkblatt 1 f\u00fcr Arbeitslose, S. 55: Die Dauer einer Sperrzeit bei unzureichenden Eigenbem\u00fchungen betr\u00e4gt zwei Wochen. (0,25 p). Frage: Mit welcher Folge und welcher Dauer m\u00fcssen Sie rechnen, wenn Sie Ihre notwendigen Eigenbem\u00fchungen nicht rechtzeitig oder nicht vollst\u00e4ndig erf\u00fcllen?'\ninputs = tokenizer(example_input, max_length=256, padding='max_length', truncation=True, return_tensors='pt')\n\ngenerated_tokens = model.generate(\n                inputs['input_ids'],\n                attention_mask=inputs['attention_mask'],\n                max_length=128\n            )\noutput = tokenizer.batch_decode(generated_tokens, skip_special_tokens=True)[0]\n```\n\nThe output produced by the model then looks as follows:\n\n```\nPartially correct Feedback: Es ist richtig, dass Sie mit einer Sperrzeit rechnen m\u00fcssen, in der Sie keine Leistung bekommen. Die gesetzlich vorgesehene Sperrzeit bei unzureichenden Eigenbem\u00fchungen betr\u00e4gt jedoch zwei Wochen.\n```\n", "size_bytes": "2444583325", "downloads": 14}