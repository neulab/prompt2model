{"pretrained_model_name": "thu-coai/blenderbot-400M-esconv", "description": "---\nlanguage:\n- en\ntags:\n- pytorch\n- coai\npipeline_tag: conversational\n\n---\n\n[blenderbot-400M-distill](https://huggingface.co/facebook/blenderbot-400M-distill) fine-tuned on the [ESConv dataset](https://github.com/thu-coai/Emotional-Support-Conversation). Usage example:\n\n```python\nimport torch\nfrom transformers import AutoTokenizer\nfrom transformers.models.blenderbot import BlenderbotTokenizer, BlenderbotForConditionalGeneration\n\ndef _norm(x):\n    return ' '.join(x.strip().split())\n\ntokenizer = BlenderbotTokenizer.from_pretrained('thu-coai/blenderbot-400M-esconv')\nmodel = BlenderbotForConditionalGeneration.from_pretrained('thu-coai/blenderbot-400M-esconv')\nmodel.eval()\n\nutterances = [\n    \"I am having a lot of anxiety about quitting my current job. It is too stressful but pays well\",\n    \"What makes your job stressful for you?\",\n    \"I have to deal with many people in hard financial situations and it is upsetting\",\n    \"Do you help your clients to make it to a better financial situation?\",\n    \"I do, but often they are not going to get back to what they want. Many people are going to lose their home when safeguards are lifted\",\n]\ninput_sequence = '  '.join([' ' + e for e in utterances]) + tokenizer.eos_token # add space prefix and separate utterances with two spaces\ninput_ids = tokenizer.convert_tokens_to_ids(tokenizer.tokenize(input_sequence))[-128:]\ninput_ids = torch.LongTensor([input_ids])\n\nmodel_output = model.generate(input_ids, num_beams=1, do_sample=True, top_p=0.9, num_return_sequences=5, return_dict=False)\ngeneration = tokenizer.batch_decode(model_output, skip_special_tokens=True)\ngeneration = [_norm(e) for e in generation]\nprint(generation)\n\nutterances.append(generation[0]) # for future loop\n```\n\n\nPlease kindly cite the [original paper](https://arxiv.org/abs/2106.01144) if you use this model:\n\n```bib\n@inproceedings{liu-etal-2021-towards,\n  title={Towards Emotional Support Dialog Systems},\n  author={Liu, Siyang  and \n    Zheng, Chujie  and \n    Demasi, Orianna  and \n    Sabour, Sahand  and \n    Li, Yu  and \n    Yu, Zhou  and \n    Jiang, Yong  and \n    Huang, Minlie},\n  booktitle={Proceedings of the 59th annual meeting of the Association for Computational Linguistics},\n  year={2021}\n}\n```\n", "size_bytes": "1459354817", "downloads": 43}