{"pretrained_model_name": "gonglinyuan/metro_t0p_base", "description": "---\nlicense: mit\nlanguage:\n- en\ntags:\n- t5\nmodel-index:\n- name: metro_t0p_base\n  results:\n  - task:\n      type: natural-language-inference\n    dataset:\n      type: super_glue\n      name: RTE\n      config: rte\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 64.90974729241879\n  - task:\n      type: natural-language-inference\n    dataset:\n      type: super_glue\n      name: CB\n      config: cb\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 44.642857142857146\n  - task:\n      type: natural-language-inference\n    dataset:\n      type: anli\n      name: ANLI R1\n      split: dev_r1\n    metrics:\n      - type: accuracy\n        value: 32.35333333333333\n  - task:\n      type: natural-language-inference\n    dataset:\n      type: anli\n      name: ANLI R2\n      split: dev_r2\n    metrics:\n      - type: accuracy\n        value: 32.199999999999996\n  - task:\n      type: natural-language-inference\n    dataset:\n      type: anli\n      name: ANLI R3\n      split: dev_r3\n    metrics:\n      - type: accuracy\n        value: 32.9\n  - task:\n      type: coreference-resolution\n    dataset:\n      type: super_glue\n      name: WSC\n      config: wsc.fixed\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 61.34615384615385\n  - task:\n      type: coreference-resolution\n    dataset:\n      type: winogrande\n      name: Winogrande XL\n      config: winogrande_xl\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 50.860299921073405\n  - task:\n      type: multiple-choice-qa\n    dataset:\n      type: super_glue\n      name: COPA\n      config: copa\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 61.5\n  - task:\n      type: multiple-choice-qa\n    dataset:\n      type: story_cloze\n      name: StoryCloze 2016\n      config: '2016'\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 82.59754142169962\n  - task:\n      type: multiple-choice-qa\n    dataset:\n      type: hellaswag\n      name: HellaSwag\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 43.22097191794464\n  - task:\n      type: word-sense-disambiguation\n    dataset:\n      type: super_glue\n      name: WiC\n      config: wic\n      split: validation\n    metrics:\n      - type: accuracy\n        value: 51.20689655172414\n---\n\nOfficial repository: https://github.com/gonglinyuan/metro_t0\n\n# METRO-T0\n\nPaper: [Model-Generated Pretraining Signals Improves Zero-Shot Generalization of Text-to-Text Transformers](https://arxiv.org/abs/2305.12567) (ACL 2023)\n\nMETRO-T0 is a T5-style text-to-text Transformer pretrained using model-generated pretraining signals, prompt-finetuned on a family of public NLP tasks proposed in [T0](https://arxiv.org/abs/2110.08207).\nMETRO-T0 is highly parameter efficient. For example, METRO-T0-Large++ (775M parameters) outperforms GPT-3 (175B parameters) and T0-3B (3B parameters) on a wide range of NLP tasks.\n\n![The architecture of METRO-T0 during pretraining using BERT as the auxiliary model to generate signals](https://github.com/gonglinyuan/metro_t0/raw/main/assets/metro_t0_method.png)\n\n![Prompt learning results of METRO-T0 versus our T0 baseline and T03B by Sanh et al. (2022) on 4 tasks  in the T0 Eval benchmark. Each point denotes the accuracy using one prompt template, except that the median accuracy over all templates of T03B is indicated by the blue point. The plots of other tasks are in our paper.](https://github.com/gonglinyuan/metro_t0/raw/main/assets/metro_t0_selected_results.png)\n\n## Use METRO-T0+-Base\n\nTo use METRO-T0+-Base in PyTorch (Python 3.7+, PyTorch 1.12+ and transformers 4.17+ are prerequisites), refer to the code snippet below:\n\n```python\nfrom transformers import AutoModelForSeq2SeqLM, AutoTokenizer\n\nmodel = AutoModelForSeq2SeqLM.from_pretrained(\"gonglinyuan/metro_t0p_base\", trust_remote_code=True)\ntokenizer = AutoTokenizer.from_pretrained(\"gonglinyuan/metro_t0p_base\", trust_remote_code=True)\n\ninput_text = \"Is this review positive or negative? Review: this is the best cast iron skillet you will ever buy\"\ninputs = tokenizer([input_text], max_length=512, truncation=True, add_special_tokens=True, return_tensors=\"pt\").input_ids\noutputs = model.generate(inputs, max_new_tokens=256, do_sample=False)\n\nprint(tokenizer.decode(outputs[0], skip_special_tokens=True))  # expected: positive\n```\n\n## Other METRO-T0 Models\n\n|                    | # Parameters | Pretraining Data | Prompt-Finetuning Data |\n|--------------------|--------------|------------------|------------------------|\n| [METRO-T0-Base](https://huggingface.co/gonglinyuan/metro_t0_base)      | 226M         | Wikibook (16G)   | T0 Train               |\n| [METRO-T0+-Base](https://huggingface.co/gonglinyuan/metro_t0p_base)     | 226M         | Wikibook (16G)   | T0+ Train              |\n| [METRO-T0++-Base](https://huggingface.co/gonglinyuan/metro_t0pp_base)    | 226M         | Wikibook (16G)   | T0++ Train             |\n| [METRO-T0-Base++](https://huggingface.co/gonglinyuan/metro_t0_basepp)    | 256M         | 160G corpus      | T0 Train               |\n| [METRO-T0+-Base++](https://huggingface.co/gonglinyuan/metro_t0p_basepp)   | 256M         | 160G corpus      | T0+ Train              |\n| [METRO-T0++-Base++](https://huggingface.co/gonglinyuan/metro_t0pp_basepp)  | 256M         | 160G corpus      | T0++ Train             |\n| [METRO-T0-Large++](https://huggingface.co/gonglinyuan/metro_t0_largepp)   | 775M         | 160G corpus      | T0 Train               |\n| [METRO-T0+-Large++](https://huggingface.co/gonglinyuan/metro_t0p_largepp)  | 775M         | 160G corpus      | T0+ Train              |\n| [METRO-T0++-Large++](https://huggingface.co/gonglinyuan/metro_t0pp_largepp) | 775M         | 160G corpus      | T0++ Train             |\n\n\n## Citation\n\nIf you find the code and models useful for your research, please cite the following paper:\n\n```\n@misc{gong2023modelgenerated,\n      title={Model-Generated Pretraining Signals Improves Zero-Shot Generalization of Text-to-Text Transformers}, \n      author={Linyuan Gong and Chenyan Xiong and Xiaodong Liu and Payal Bajaj and Yiqing Xie and Alvin Cheung and Jianfeng Gao and Xia Song},\n      year={2023},\n      eprint={2305.12567},\n      archivePrefix={arXiv},\n      primaryClass={cs.CL},\n      url={https://arxiv.org/abs/2305.12567}\n}\n```", "size_bytes": "902641451", "downloads": 2}