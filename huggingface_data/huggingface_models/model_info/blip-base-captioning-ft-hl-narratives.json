{"pretrained_model_name": "michelecafagna26/blip-base-captioning-ft-hl-narratives", "description": "---\nlicense: apache-2.0\ntags:\n- image-captioning\nlanguages:\n- en\npipeline_tag: image-to-text\ndatasets:\n- michelecafagna26/hl-narratives\nlanguage:\n- en\nmetrics:\n- sacrebleu\n- rouge\nlibrary_name: transformers\n---\n## BLIP-base fine-tuned for Narrative Image Captioning\n\n[BLIP](https://arxiv.org/abs/2201.12086) base trained on the [HL Narratives](https://huggingface.co/datasets/michelecafagna26/hl-narratives) for **high-level narrative descriptions generation**\n\n## Model fine-tuning \ud83c\udfcb\ufe0f\u200d\n\n- Trained for a 3 epochs\n- lr:  5e\u22125\n- Adam optimizer\n- half-precision (fp16)\n\n## Test set metrics \ud83e\uddfe\n\n    | Cider  | SacreBLEU  | Rouge-L|\n    |--------|------------|--------|\n    | 79.39  |   11.70    |  26.17 |\n\n## Model in Action \ud83d\ude80\n\n```python\nimport requests\nfrom PIL import Image\nfrom transformers import BlipProcessor, BlipForConditionalGeneration\n\nprocessor = BlipProcessor.from_pretrained(\"blip-base-captioning-ft-hl-narratives\")\nmodel = BlipForConditionalGeneration.from_pretrained(\"blip-base-captioning-ft-hl-narratives\").to(\"cuda\")\n\nimg_url = 'https://datasets-server.huggingface.co/assets/michelecafagna26/hl/--/default/train/0/image/image.jpg' \nraw_image = Image.open(requests.get(img_url, stream=True).raw).convert('RGB')\n\n\ninputs = processor(raw_image, return_tensors=\"pt\").to(\"cuda\")\npixel_values = inputs.pixel_values\n\ngenerated_ids = model.generate(pixel_values=pixel_values, max_length=50,\n            do_sample=True,\n            top_k=120,\n            top_p=0.9,\n            early_stopping=True,\n            num_return_sequences=1)\n\nprocessor.batch_decode(generated_ids, skip_special_tokens=True)\n\n>>> \"she is holding an umbrella near a lake and is on vacation.\"\n```\n\n## BibTex and citation info\n\n```BibTeX\n@inproceedings{cafagna2023hl,\n  title={{HL} {D}ataset: {V}isually-grounded {D}escription of {S}cenes, {A}ctions and\n{R}ationales},\n  author={Cafagna, Michele and van Deemter, Kees and Gatt, Albert},\n  booktitle={Proceedings of the 16th International Natural Language Generation Conference (INLG'23)},\naddress = {Prague, Czech Republic},\n  year={2023}\n}\n```", "size_bytes": "989827505", "downloads": 13}