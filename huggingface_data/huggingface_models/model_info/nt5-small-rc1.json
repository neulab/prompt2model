{"pretrained_model_name": "nielsr/nt5-small-rc1", "description": "---\nlicense: apache-2.0\ntags:\ndatasets:\n- drop\n---\n\n# NT5, a T5 model trained to perform numerical reasoning\n\nT5-small model pre-trained on 3 million (partly synthetic) texts and fine-tuned on [DROP](https://allennlp.org/drop.html). It was introduced in the paper [NT5?! Training T5 to Perform Numerical Reasoning](https://arxiv.org/abs/2104.07307) by Yang et al. and first released in [this repository](https://github.com/lesterpjy/numeric-t5). As the original implementation was in Tensorflow 2, I've converted the weigths to PyTorch. This model corresponds to RC Experiment 1 (see the paper), their best performing model.\n\nDisclaimer: The team releasing NT5 did not write a model card for this model so this model card has been written by me.\n\n## Model description\n\nThe NT5 model is a T5 model, in other words, an encoder-decoder Transformer. In order to encourage numerical reasoning, the model was further pre-trained on three datasets designed to strengthen skills necessary for numerical reasoning over text (NRoT) and general reading comprehension before being fine-tuned on the Discrete Reasoning over Text (DROP) dataset.\n\n## Intended uses & limitations\n\nYou can use the model for numerical reasoning over text. \n\n### How to use\n\nHere is how to use this model:\n\n```python\nfrom transformers import T5Tokenizer, T5ForConditionalGeneration\n\ncontext = \"\"\"Saint Jean de Br\u00e9beuf was a French Jesuit missionary who\ntravelled to New France in 1625. There he worked primarily with the Huron\nfor the rest of his life, except for a few years in France from 1629 to\n1633. He learned their language and culture, writing extensively about\neach to aid other missionaries. In 1649, Br\u00b4ebeuf and another missionary\nwere captured when an Iroquois raid took over a Huron village . Together\nwith Huron captives, the missionaries were ritually tortured and killed\non March 16, 1649. Br\u00b4ebeuf was beatified in 1925 and among eight Jesuit\nmissionaries canonized as saints in the Roman Catholic Church in 1930.\"\"\"\n\nquestion = \"How many years did Saint Jean de Br\u00e9beuf stay in New France \nbefore he went back to France for a few years?\"\n\ntokenizer = T5Tokenizer.from_pretrained(\"nielsr/nt5-small-rc1\")\nmodel = T5ForConditionalGeneration.from_pretrained(\"nielsr/nt5-small-rc1\")\n\n# encode context & question\ninput_text = f\"answer_me: {question} context: {context}\"\nencoded_query = tokenizer(\n                    input_text, \n                    return_tensors='pt', \n                    padding='max_length', \n                    truncation=True, \n                    max_length=512)\n\n# generate answer\ngenerated_answer = model.generate(input_ids=encoded_query[\"input_ids\"], \n                                  attention_mask=encoded_query[\"attention_mask\"], \n                                  max_length=54)\n\ndecoded_answer = tokenizer.decode(generated_answer.numpy()[0])\nprint(\"T5 Answer: \", decoded_answer)\nT5 Answer: 4\n```\n\n## Evaluation results\n\nThis model achieves an F1 score of 0.7031 and exact match of 0.6687 on the development set of DROP. \n\n\n### BibTeX entry and citation info\n\n```bibtex\n@misc{yang2021nt5,\n      title={NT5?! Training T5 to Perform Numerical Reasoning}, \n      author={Peng-Jian Yang and Ying Ting Chen and Yuechan Chen and Daniel Cer},\n      year={2021},\n      eprint={2104.07307},\n      archivePrefix={arXiv},\n      primaryClass={cs.CL}\n}\n```\n\n```bibtex\n@article{DBLP:journals/corr/abs-1903-00161,\n  author    = {Dheeru Dua and\n               Yizhong Wang and\n               Pradeep Dasigi and\n               Gabriel Stanovsky and\n               Sameer Singh and\n               Matt Gardner},\n  title     = {{DROP:} {A} Reading Comprehension Benchmark Requiring Discrete Reasoning\n               Over Paragraphs},\n  journal   = {CoRR},\n  volume    = {abs/1903.00161},\n  year      = {2019},\n  url       = {http://arxiv.org/abs/1903.00161},\n  archivePrefix = {arXiv},\n  eprint    = {1903.00161},\n  timestamp = {Wed, 03 Jul 2019 07:17:04 +0200},\n  biburl    = {https://dblp.org/rec/journals/corr/abs-1903-00161.bib},\n  bibsource = {dblp computer science bibliography, https://dblp.org}\n}\na service of Schloss Dagstuhl - Leibniz Center for Informatics\\\\\\\\thomebrowsesearchabout\n\n```", "size_bytes": "242087498", "downloads": 13}