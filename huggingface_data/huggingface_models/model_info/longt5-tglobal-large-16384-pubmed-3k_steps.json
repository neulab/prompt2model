{"pretrained_model_name": "Stancld/longt5-tglobal-large-16384-pubmed-3k_steps", "description": "---\nlanguage: en\ndatasets:\n - ccdv/pubmed-summarization\n  \nlicense: apache-2.0\n---\n\n## Introduction\n\n[Google's LongT5: Efficient Text-To-Text Transformer for Long Sequences](https://arxiv.org/pdf/2112.07916.pdf) introduced as an extension of a successful [T5 model](https://arxiv.org/pdf/1910.10683.pdf).\n\nThis is an unofficial *longt5-large-16384-pubmed-3k_steps* checkpoint. I.e., this is a large configuration of the LongT5 model with a `transient-global` attention fine-tuned on [pubmed summarization dataset](https://huggingface.co/datasets/ccdv/pubmed-summarization) for 3,000 training steps. It may be worth continuing in the fine-tuning as we did not train the model until the convergence.\n\n## Results and Fine-tuning Details \n\nThe fine-tuned model achieves the following results on the evaluation set using `beam_search=3` and without any specific calibration of generation parameters are presented below, altogether with the results from the original paper (the original scores are higher, very likely due to a higher number of training steps).\n\n| Metric | Score | Score (original paper)\n| --- | --- | --- |\n| Rouge-1 | 47.44 | 49.98 |\n| Rouge-2 | 22.68 | 24.69 |\n| Rouge-L | 29.83 | x |\n| Rouge-Lsum | 43.13 | 46.46 |\n\nThe training parameters follow the ones specified in the paper. We accumulated batch size to 128 examples and used `Adafactor` optimizer with a constant learning rate `0.001`. The full training hyper-parameters and logs can be found via the following [W&B run](https://wandb.ai/stancld/LongT5/runs/1lwncl8a?workspace=user-stancld). The model was trained using the [HuggingFace's trainer](https://github.com/huggingface/transformers/blob/main/src/transformers/trainer_seq2seq.py).\n\nThe only specific adjustment, I made for the training, was dropping very short input articles (less than 16 words (a bit of mistake, should be less than 16 tokens)) as this sequences do not contribute to gradient creation in the *transient-global* attention, which resulted in training crashes when DDP used.\n\n## Usage\n\n```python \nLONG_ARTICLE = \"\"\"\"anxiety affects quality of life in those living\nwith parkinson 's disease ( pd ) more so than\noverall cognitive status , motor deficits , apathy\n, and depression [ 13 ] . although anxiety and\ndepression are often related and coexist in pd\npatients , recent research suggests that anxiety\nrather than depression is the most prominent and\nprevalent mood disorder in pd [ 5 , 6 ] . yet ,\nour current understanding of anxiety and its\nimpact on cognition in pd , as well as its neural\nbasis and best treatment practices , remains\nmeager and lags far behind that of depression .\noverall , neuropsychiatric symptoms in pd have\nbeen shown to be negatively associated with\ncognitive performance . for example , higher\ndepression scores have been correlated with lower\nscores on the mini - mental state exam ( mmse ) [\n8 , 9 ] as well as tests of memory and executive\nfunctions ( e.g. , attention ) [ 1014 ] . likewise\n, apathy and anhedonia in pd patients have been\nassociated with executive dysfunction [ 10 , 1523\n] . however , few studies have specifically\ninvestigated the relationship between anxiety and\ncognition in pd . one study showed a strong\nnegative relationship between anxiety ( both state\nand trait ) and overall cognitive performance (\nmeasured by the total of the repeatable battery\nfor the assessment of neuropsychological status\nindex ) within a sample of 27 pd patients .\nfurthermore , trait anxiety was negatively\nassociated with each of the cognitive domains\nassessed by the rbans ( i.e. , immediate memory ,\nvisuospatial construction , language , attention ,\nand delayed memory ) . two further studies have\nexamined whether anxiety differentially affects\ncognition in patients with left - sided dominant\npd ( lpd ) versus right - sided dominant pd ( rpd\n) ; however , their findings were inconsistent .\nthe first study found that working memory\nperformance was worse in lpd patients with anxiety\ncompared to rpd patients with anxiety , whereas\nthe second study reported that , in lpd , apathy\nbut not anxiety was associated with performance on\nnonverbally mediated executive functions and\nvisuospatial tasks ( e.g. , tmt - b , wms - iii\nspatial span ) , while in rpd , anxiety but not\napathy significantly correlated with performance\non verbally mediated tasks ( e.g. , clock reading\ntest and boston naming test ) . furthermore ,\nanxiety was significantly correlated with\nneuropsychological measures of attention and\nexecutive and visuospatial functions . taken\ntogether , it is evident that there are limited\nand inconsistent findings describing the\nrelationship between anxiety and cognition in pd\nand more specifically how anxiety might influence\nparticular domains of cognition such as attention\nand memory and executive functioning . it is also\nstriking that , to date , no study has examined\nthe influence of anxiety on cognition in pd by\ndirectly comparing groups of pd patients with and\nwithout anxiety while excluding depression . given\nthat research on healthy young adults suggests\nthat anxiety reduces processing capacity and\nimpairs processing efficiency , especially in the\ncentral executive and attentional systems of\nworking memory [ 26 , 27 ] , we hypothesized that\npd patients with anxiety would show impairments in\nattentional set - shifting and working memory\ncompared to pd patients without anxiety .\nfurthermore , since previous work , albeit limited\n, has focused on the influence of symptom\nlaterality on anxiety and cognition , we also\nexplored this relationship . seventeen pd patients\nwith anxiety and thirty - three pd patients\nwithout anxiety were included in this study ( see\ntable 1 ) . the cross - sectional data from these\nparticipants was taken from a patient database\nthat has been compiled over the past 8 years (\nsince 2008 ) at the parkinson 's disease research\nclinic at the brain and mind centre , university\nof sydney . inclusion criteria involved a\ndiagnosis of idiopathic pd according to the united\nkingdom parkinson 's disease society brain bank\ncriteria   and were confirmed by a neurologist (\nsjgl ) . patients also had to have an adequate\nproficiency in english and have completed a full\nneuropsychological assessment . ten patients in\nthis study ( 5 pd with anxiety ; 5 pd without\nanxiety ) were taking psychotropic drugs ( i.e. ,\nbenzodiazepine or selective serotonin reuptake\ninhibitor ) . patients were also excluded if they\nhad other neurological disorders , psychiatric\ndisorders other than affective disorders ( such as\nanxiety ) , or if they reported a score greater\nthan six on the depression subscale of the\nhospital anxiety and depression scale ( hads ) .\nthus , all participants who scored within a\ndepressed  ( hads - d > 6 ) range were excluded\nfrom this study , in attempt to examine a refined\nsample of pd patients with and without anxiety in\norder to determine the independent effect of\nanxiety on cognition . this research was approved\nby the human research ethics committee of the\nuniversity of sydney , and written informed\nconsent was obtained from all participants . self\n- reported hads was used to assess anxiety in pd\nand has been previously shown to be a useful\nmeasure of clinical anxiety in pd . a cut - off\nscore of > 8 on the anxiety subscale of the hads (\nhads - a ) was used to identify pd cases with\nanxiety ( pda+ ) , while a cut - off score of < 6\non the hads - a was used to identify pd cases\nwithout anxiety ( pda ) . this criterion was more\nstringent than usual ( > 7 cut - off score ) , in\neffort to create distinct patient groups . the\nneurological evaluation rated participants\naccording to hoehn and yahr ( h&y ) stages   and\nassessed their motor symptoms using part iii of\nthe revised mds task force unified parkinson 's\ndisease rating scale ( updrs ) . in a similar way\nthis was determined by calculating a total left\nand right score from rigidity items 3035 ,\nvoluntary movement items 3643 , and tremor items\n5057 from the mds - updrs part iii ( see table 1 )\n. processing speed was assessed using the trail\nmaking test , part a ( tmt - a , z - score ) .\nattentional set - shifting was measured using the\ntrail making test , part b ( tmt - b , z - score )\n. working memory was assessed using the digit span\nforward and backward subtest of the wechsler\nmemory scale - iii ( raw scores ) . language was\nassessed with semantic and phonemic verbal fluency\nvia the controlled oral word associated test (\ncowat animals and letters , z - score ) . the\nability to retain learned verbal memory was\nassessed using the logical memory subtest from the\nwechsler memory scale - iii ( lm - i z - score ,\nlm - ii z - score , % lm retention z - score ) .\nthe mini - mental state examination ( mmse )\ndemographic , clinical , and neuropsychological\nvariables were compared between the two groups\nwith the independent t - test or mann  whitney u\ntest , depending on whether the variable met\nparametric assumptions . chi - square tests were\nused to examine gender and symptom laterality\ndifferences between groups . all analyses employed\nan alpha level of p < 0.05 and were two - tailed .\nspearman correlations were performed separately in\neach group to examine associations between anxiety\nand/or depression ratings and cognitive functions\n. as expected , the pda+ group reported\nsignificant greater levels of anxiety on the hads\n- a ( u = 0 , p < 0.001 ) and higher total score\non the hads ( u = 1 , p < 0.001 ) compared to the\npda group ( table 1 ) . groups were matched in age\n( t(48 ) = 1.31 , p = 0.20 ) , disease duration (\nu = 259 , p = 0.66 ) , updrs - iii score ( u =\n250.5 , p = 0.65 ) , h&y ( u = 245 , p = 0.43 ) ,\nledd ( u = 159.5 , p = 0.80 ) , and depression (\nhads - d ) ( u = 190.5 , p = 0.06 ) . additionally\n, all groups were matched in the distribution of\ngender (  = 0.098 , p = 0.75 ) and side - affected\n(  = 0.765 , p = 0.38 ) . there were no group\ndifferences for tmt - a performance ( u = 256 , p\n= 0.62 ) ( table 2 ) ; however , the pda+ group\nhad worse performance on the trail making test\npart b ( t(46 ) = 2.03 , p = 0.048 ) compared to\nthe pda group ( figure 1 ) . the pda+ group also\ndemonstrated significantly worse performance on\nthe digit span forward subtest ( t(48 ) = 2.22 , p\n= 0.031 ) and backward subtest ( u = 190.5 , p =\n0.016 ) compared to the pda group ( figures 2(a )\nand 2(b ) ) . neither semantic verbal fluency (\nt(47 ) = 0.70 , p = 0.49 ) nor phonemic verbal\nfluency ( t(47 ) = 0.39 , p = 0.70 ) differed\nbetween groups . logical memory i immediate recall\ntest ( u = 176 , p = 0.059 ) showed a trend that\nthe pda+ group had worse new verbal learning and\nimmediate recall abilities than the pda group .\nhowever , logical memory ii test performance ( u =\n219 , p = 0.204 ) and logical memory % retention (\nu = 242.5 , p = 0.434 ) did not differ between\ngroups . there were also no differences between\ngroups in global cognition ( mmse ) ( u = 222.5 ,\np = 0.23 ) . participants were split into lpd and\nrpd , and then further group differences were\nexamined between pda+ and pda. importantly , the\ngroups remained matched in age , disease duration\n, updrs - iii , dde , h&y stage , and depression\nbut remained significantly different on self -\nreported anxiety . lpda+ demonstrated worse\nperformance on the digit span forward test ( t(19\n) = 2.29 , p = 0.033 ) compared to lpda , whereas\nrpda+ demonstrated worse performance on the digit\nspan backward test ( u = 36.5 , p = 0.006 ) , lm -\ni immediate recall ( u = 37.5 , p = 0.008 ) , and\nlm - ii ( u = 45.0 , p = 0.021 ) but not lm %\nretention ( u = 75.5 , p = 0.39 ) compared to\nrpda. this study is the first to directly compare\ncognition between pd patients with and without\nanxiety . the findings confirmed our hypothesis\nthat anxiety negatively influences attentional set\n- shifting and working memory in pd . more\nspecifically , we found that pd patients with\nanxiety were more impaired on the trail making\ntest part b which assessed attentional set -\nshifting , on both digit span tests which assessed\nworking memory and attention , and to a lesser\nextent on the logical memory test which assessed\nmemory and new verbal learning compared to pd\npatients without anxiety . taken together , these\nfindings suggest that anxiety in pd may reduce\nprocessing capacity and impair processing\nefficiency , especially in the central executive\nand attentional systems of working memory in a\nsimilar way as seen in young healthy adults [ 26 ,\n27 ] . although the neurobiology of anxiety in pd\nremains unknown , many researchers have postulated\nthat anxiety disorders are related to\nneurochemical changes that occur during the early\n, premotor stages of pd - related degeneration [\n37 , 38 ] such as nigrostriatal dopamine depletion\n, as well as cell loss within serotonergic and\nnoradrenergic brainstem nuclei ( i.e. , raphe\nnuclei and locus coeruleus , resp . , which\nprovide massive inputs to corticolimbic regions )\n. over time , chronic dysregulation of\nadrenocortical and catecholamine functions can\nlead to hippocampal damage as well as\ndysfunctional prefrontal neural circuitries [ 39 ,\n40 ] , which play a key role in memory and\nattention . recent functional neuroimaging work\nhas suggested that enhanced hippocampal activation\nduring executive functioning and working memory\ntasks may represent compensatory processes for\nimpaired frontostriatal functions in pd patients\ncompared to controls . therefore , chronic stress\nfrom anxiety , for example , may disrupt\ncompensatory processes in pd patients and explain\nthe cognitive impairments specifically in working\nmemory and attention seen in pd patients with\nanxiety . it has also been suggested that\nhyperactivation within the putamen may reflect a\ncompensatory striatal mechanism to maintain normal\nworking memory performance in pd patients ;\nhowever , losing this compensatory activation has\nbeen shown to contribute to poor working memory\nperformance . anxiety in mild pd has been linked\nto reduced putamen dopamine uptake which becomes\nmore extensive as the disease progresses . this\nfurther supports the notion that anxiety may\ndisrupt compensatory striatal mechanisms as well ,\nproviding another possible explanation for the\ncognitive impairments observed in pd patients with\nanxiety in this study . noradrenergic and\nserotonergic systems should also be considered\nwhen trying to explain the mechanisms by which\nanxiety may influence cognition in pd . although\nthese neurotransmitter systems are relatively\nunderstudied in pd cognition , treating the\nnoradrenergic and serotonergic systems has shown\nbeneficial effects on cognition in pd . selective\nserotonin reuptake inhibitor , citalopram , was\nshown to improve response inhibition deficits in\npd , while noradrenaline reuptake blocker ,\natomoxetine , has been recently reported to have\npromising effects on cognition in pd [ 45 , 46 ] .\noverall , very few neuroimaging studies have been\nconducted in pd in order to understand the neural\ncorrelates of pd anxiety and its underlying neural\npathology . future research should focus on\nrelating anatomical changes and neurochemical\nchanges to neural activation in order to gain a\nclearer understanding on how these pathologies\naffect anxiety in pd . to further understand how\nanxiety and cognitive dysfunction are related ,\nfuture research should focus on using advanced\nstructural and function imaging techniques to\nexplain both cognitive and neural breakdowns that\nare associated with anxiety in pd patients .\nresearch has indicated that those with amnestic\nmild cognitive impairment who have more\nneuropsychiatric symptoms have a greater risk of\ndeveloping dementia compared to those with fewer\nneuropsychiatric symptoms . future studies should\nalso examine whether treating neuropsychiatric\nsymptoms might impact the progression of cognitive\ndecline and improve cognitive impairments in pd\npatients . previous studies have used pd symptom\nlaterality as a window to infer asymmetrical\ndysfunction of neural circuits . for example , lpd\npatients have greater inferred right hemisphere\npathology , whereas rpd patients have greater\ninferred left hemisphere pathology . thus ,\ncognitive domains predominantly subserved by the\nleft hemisphere ( e.g. , verbally mediated tasks\nof executive function and verbal memory ) might be\nhypothesized to be more affected in rpd than lpd ;\nhowever , this remains controversial . it has also\nbeen suggested that since anxiety is a common\nfeature of left hemisphere involvement [ 48 , 49 ]\n, cognitive domains subserved by the left\nhemisphere may also be more strongly related to\nanxiety . results from this study showed selective\nverbal memory deficits in rpd patients with\nanxiety compared to rpd without anxiety , whereas\nlpd patients with anxiety had greater attentional\n/ working memory deficits compared to lpd without\nanxiety . although these results align with\nprevious research , interpretations of these\nfindings should be made with caution due to the\nsmall sample size in the lpd comparison\nspecifically . recent work has suggested that the\nhads questionnaire may underestimate the burden of\nanxiety related symptomology and therefore be a\nless sensitive measure of anxiety in pd [ 30 , 50\n] . in addition , our small sample size also\nlimited the statistical power for detecting\nsignificant findings . based on these limitations\n, our findings are likely conservative and\nunderrepresent the true impact anxiety has on\ncognition in pd . additionally , the current study\nemployed a very brief neuropsychological\nassessment including one or two tests for each\ncognitive domain . future studies are encouraged\nto collect a more complex and comprehensive\nbattery from a larger sample of pd participants in\norder to better understand the role anxiety plays\non cognition in pd . another limitation of this\nstudy was the absence of diagnostic interviews to\ncharacterize participants ' psychiatric symptoms\nand specify the type of anxiety disorders included\nin this study . future studies should perform\ndiagnostic interviews with participants ( e.g. ,\nusing dsm - v criteria ) rather than relying on\nself - reported measures to group participants ,\nin order to better understand whether the type of\nanxiety disorder ( e.g. , social anxiety , phobias\n, panic disorders , and generalized anxiety )\ninfluences cognitive performance differently in pd\n. one advantage the hads questionnaire provided\nover other anxiety scales was that it assessed\nboth anxiety and depression simultaneously and\nallowed us to control for coexisting depression .\nalthough there was a trend that the pda+ group\nself - reported higher levels of depression than\nthe pda group , all participants included in the\nstudy scored < 6 on the depression subscale of the\nhads . controlling for depression while assessing\nanxiety has been identified as a key shortcoming\nin the majority of recent work . considering many\nprevious studies have investigated the influence\nof depression on cognition in pd without\naccounting for the presence of anxiety and the\ninconsistent findings reported to date , we\nrecommend that future research should try to\ndisentangle the influence of anxiety versus\ndepression on cognitive impairments in pd .\nconsidering the growing number of clinical trials\nfor treating depression , there are few if any for\nthe treatment of anxiety in pd . anxiety is a key\ncontributor to decreased quality of life in pd and\ngreatly requires better treatment options .\nmoreover , anxiety has been suggested to play a\nkey role in freezing of gait ( fog ) , which is\nalso related to attentional set - shifting [ 52 ,\n53 ] . future research should examine the link\nbetween anxiety , set - shifting , and fog , in\norder to determine whether treating anxiety might\nbe a potential therapy for improving fog .\"\"\"\n\nimport torch\nfrom transformers import AutoTokenizer, LongT5ForConditionalGeneration\n\ntokenizer = AutoTokenizer.from_pretrained(\"Stancld/longt5-tglobal-large-16384-pubmed-3k_steps\")\n\ninput_ids = tokenizer(LONG_ARTICLE, return_tensors=\"pt\").input_ids.to(\"cuda\")\n\nmodel = LongT5ForConditionalGeneration.from_pretrained(\"Stancld/longt5-tglobal-large-16384-pubmed-3k_steps\", return_dict_in_generate=True).to(\"cuda\")\n\nsequences = model.generate(input_ids).sequences\n\nsummary = tokenizer.batch_decode(sequences)\n```", "size_bytes": "3132671411", "downloads": 835}