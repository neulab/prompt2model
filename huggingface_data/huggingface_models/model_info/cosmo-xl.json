{"pretrained_model_name": "allenai/cosmo-xl", "description": "---\nlanguage: \n  - en\ntags:\n- conversational\n- dialogue\n- response generation\nlicense: apache-2.0\ndatasets:\n- allenai/soda\n- allenai/prosocial-dialog\n---\n\n# Model Card for \ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude80COSMO\n\n\ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude80COSMO is a conversation agent with greater generalizability on both in- and out-of-domain chitchat datasets (e.g., DailyDialog, BlendedSkillTalk). It is trained on two datasets: SODA and ProsocialDialog. COSMO is especially aiming to model natural human conversations. It can accept situation descriptions as well as instructions on what role it should play in the situation.\n\n## Model Description\n- **Repository:** [Code](https://github.com/skywalker023/sodaverse)\n- **Paper:** [SODA: Million-scale Dialogue Distillation with Social Commonsense Contextualization](https://arxiv.org/abs/2212.10465)\n- **Point of Contact:** [Hyunwoo Kim](mailto:hyunwook@allenai.org)\n\n## Model Training\n\n\ud83e\uddd1\ud83c\udffb\u200d\ud83d\ude80COSMO is trained on our two recent datasets: \ud83e\udd64[SODA](https://huggingface.co/datasets/allenai/soda) and [Prosocial Dialog](https://huggingface.co/datasets/allenai/prosocial-dialog).\nThe backbone model of COSMO is the [lm-adapted T5](https://huggingface.co/google/t5-xl-lm-adapt).\n\n### How to use\n\n> \ud83d\udca1 <b>Note:</b> The HuggingFace inference API for Cosmo is not working correctly, we gently guide you to [our repository](https://hyunw.kim/sodaverse) to try out the demo code!\n\n> \ud83d\udea8 <b>Disclaimer:</b> We would like to emphasize that COSMO is trained on SODA and ProsocialDialog mainly for academic/research purposes. We discourage using COSMO in real-world applications or services as is. Model outputs should not be used for advice for humans, and could be potentially offensive, problematic, or harmful. The model\u2019s output does not necessarily reflect the views and opinions of the authors and their associated affiliations.\n\nBelow is a simple code snippet to get Cosmo running :)\n\n```python\nimport torch\nfrom transformers import AutoTokenizer, AutoModelForSeq2SeqLM\n\ndevice = torch.device(\"cuda\" if torch.cuda.is_available() else \"cpu\")\ntokenizer = AutoTokenizer.from_pretrained(\"allenai/cosmo-xl\")\nmodel = AutoModelForSeq2SeqLM.from_pretrained(\"allenai/cosmo-xl\").to(device)\n\ndef set_input(situation_narrative, role_instruction, conversation_history):\n    input_text = \" <turn> \".join(conversation_history)\n\n    if role_instruction != \"\":\n        input_text = \"{} <sep> {}\".format(role_instruction, input_text)\n\n    if situation_narrative != \"\":\n        input_text = \"{} <sep> {}\".format(situation_narrative, input_text)\n\n    return input_text\n\ndef generate(situation_narrative, role_instruction, conversation_history):\n    \"\"\"\n    situation_narrative: the description of situation/context with the characters included (e.g., \"David goes to an amusement park\")\n    role_instruction: the perspective/speaker instruction (e.g., \"Imagine you are David and speak to his friend Sarah\").\n    conversation_history: the previous utterances in the conversation in a list\n    \"\"\"\n\n    input_text = set_input(situation_narrative, role_instruction, conversation_history) \n\n    inputs = tokenizer([input_text], return_tensors=\"pt\").to(device)\n    outputs = model.generate(inputs[\"input_ids\"], max_new_tokens=128, temperature=1.0, top_p=.95, do_sample=True)\n    response = tokenizer.decode(outputs[0], skip_special_tokens=True, clean_up_tokenization_spaces=False)\n\n    return response\n\nsituation = \"Cosmo had a really fun time participating in the EMNLP conference at Abu Dhabi.\"\ninstruction = \"You are Cosmo and you are talking to a friend.\" # You can also leave the instruction empty\n\nconversation = [\n    \"Hey, how was your trip to Abu Dhabi?\"\n]\n\nresponse = generate(situation, instruction, conversation)\nprint(response)\n```\n\n### Further Details, Social Impacts, Bias, and Limitations\nPlease refer to our [paper](https://arxiv.org/abs/2212.10465).\nCosmo is mostly trained on social chitchat. Therefore, we do not encourage having knowledge-intensive conversations (e.g., science, medical issues, law).\nSignificant research has explored bias and fairness issues with language models (see, e.g., [Sheng et al. 2021](https://aclanthology.org/2021.acl-long.330.pdf) and [Bender et al. 2021](https://dl.acm.org/doi/pdf/10.1145/3442188.3445922)). Predictions generated by the model may include disturbing and harmful stereotypes across protected classes; identity characteristics; and sensitive, social, and occupational groups.\n\n## Additional Information\n\nFor a brief summary of our paper, please see this [tweet](https://twitter.com/hyunw__kim/status/1605400305126248448).\n\n### Citation\n\nPlease cite our work if you find the resources in this repository useful:\n```\n@article{kim2022soda,\n    title={SODA: Million-scale Dialogue Distillation with Social Commonsense Contextualization},\n    author={Hyunwoo Kim and Jack Hessel and Liwei Jiang and Peter West and Ximing Lu and Youngjae Yu and Pei Zhou and Ronan Le Bras and Malihe Alikhani and Gunhee Kim and Maarten Sap and Yejin Choi},\n    journal={ArXiv},\n    year={2022},\n    volume={abs/2212.10465}\n}\n```", "size_bytes": 11925413888, "downloads": 323}