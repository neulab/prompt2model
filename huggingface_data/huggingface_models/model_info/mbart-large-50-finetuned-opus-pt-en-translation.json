{"pretrained_model_name": "Narrativa/mbart-large-50-finetuned-opus-pt-en-translation", "description": "---\nlanguage:\n- pt\n- en\ndatasets:\n- opus100\n- opusbook\ntags:\n- translation\n\nmetrics:\n- bleu\n\n---\n\n\n# mBART-large-50 fine-tuned onpus100 and opusbook for Portuguese to English translation.\n[mBART-50](https://huggingface.co/facebook/mbart-large-50/) large fine-tuned on [opus100](https://huggingface.co/datasets/viewer/?dataset=opus100) dataset for **NMT** downstream task.\n\n# Details of mBART-50 \ud83e\udde0\n\nmBART-50 is a multilingual Sequence-to-Sequence model pre-trained using the \"Multilingual Denoising Pretraining\" objective. It was introduced in [Multilingual Translation with Extensible Multilingual Pretraining and Finetuning](https://arxiv.org/abs/2008.00401) paper.\n\n\nmBART-50 is a multilingual Sequence-to-Sequence model. It was created to show that multilingual translation models can be created through multilingual fine-tuning. \nInstead of fine-tuning on one direction, a pre-trained model is fine-tuned many directions simultaneously. mBART-50 is created using the original mBART model and extended to add extra 25 languages to support multilingual machine translation models of 50 languages. The pre-training objective is explained below.\n**Multilingual Denoising Pretraining**: The model incorporates N languages by concatenating data: \n`D = {D1, ..., DN }` where each Di is a collection of monolingual documents in language `i`. The source documents are noised using two schemes, \nfirst randomly shuffling the original sentences' order, and second a novel in-filling scheme, \nwhere spans of text are replaced with a single mask token. The model is then tasked to reconstruct the original text. \n35% of each instance's words are masked by random sampling a span length according to a Poisson distribution `(\u03bb = 3.5)`.\nThe decoder input is the original text with one position offset. A language id symbol `LID` is used as the initial token to predict the sentence.\n\n\n## Details of the downstream task (NMT) - Dataset \ud83d\udcda\n\n- **Homepage:** [Link](http://opus.nlpl.eu/opus-100.php) \n- **Repository:** [GitHub](https://github.com/EdinburghNLP/opus-100-corpus)\n- **Paper:** [ARXIV](https://arxiv.org/abs/2004.11867)\n\n### Dataset Summary\n\nOPUS-100 is English-centric, meaning that all training pairs include English on either the source or target side. The corpus covers 100 languages (including English). Languages were selected based on the volume of parallel data available in OPUS.\n\n\n### Languages\n\nOPUS-100 contains approximately 55M sentence pairs. Of the 99 language pairs, 44 have 1M sentence pairs of training data, 73 have at least 100k, and 95 have at least 10k.\n\n## Dataset Structure\n\n\n### Data Fields\n\n- `src_tag`: `string` text in source language\n- `tgt_tag`: `string` translation of source language in target language\n\n### Data Splits\n\nThe dataset is split into training, development, and test portions. Data was prepared by randomly sampled up to 1M sentence pairs per language pair for training and up to 2000 each for development and test. To ensure that there was no overlap (at the monolingual sentence level) between the training and development/test data, they applied a filter during sampling to exclude sentences that had already been sampled. Note that this was done cross-lingually so that, for instance, an English sentence in the Portuguese-English portion of the training data could not occur in the Hindi-English test set.\n\n## Test set metrics \ud83e\uddfe\n\nWe got a **BLEU score of 26.12**\n    \n\n\n## Model in Action \ud83d\ude80\n\n```sh\ngit clone https://github.com/huggingface/transformers.git\npip install -q ./transformers\n```\n\n```python\nfrom transformers import MBart50TokenizerFast, MBartForConditionalGeneration\n\nckpt = 'Narrativa/mbart-large-50-finetuned-opus-pt-en-translation'\n\ntokenizer = MBart50TokenizerFast.from_pretrained(ckpt)\nmodel = MBartForConditionalGeneration.from_pretrained(ckpt).to(\"cuda\")\n\ntokenizer.src_lang = 'pt_XX'\n\ndef translate(text):\n    inputs = tokenizer(text, return_tensors='pt')\n    input_ids = inputs.input_ids.to('cuda')\n    attention_mask = inputs.attention_mask.to('cuda')\n    output = model.generate(input_ids, attention_mask=attention_mask, forced_bos_token_id=tokenizer.lang_code_to_id['en_XX'])\n    return tokenizer.decode(output[0], skip_special_tokens=True)\n    \n    \ntranslate('here your Portuguese text to be translated to English...')\n```\n\nCreated by: [Narrativa](https://www.narrativa.com/)\n\nAbout Narrativa: Natural Language Generation (NLG) | Gabriele, our machine learning-based platform, builds and deploys natural language solutions. #NLG #AI", "size_bytes": "2444702777", "downloads": 207}