{"pretrained_model_name": "ai4bharat/IndicBART", "description": "---\nlanguage:\n- as\n- bn\n- gu\n- hi\n- kn\n- ml\n- mr\n- or\n- pa\n- ta\n- te\ntags:\n- multilingual\n- nlp\n- indicnlp\n---\n\nIndicBART is a multilingual, sequence-to-sequence pre-trained model focusing on Indic languages and English. It currently supports 11 Indian languages and is based on the mBART architecture. You can use IndicBART model to build natural language generation applications for Indian languages by finetuning the model with supervised training data for tasks like machine translation, summarization, question generation, etc. Some salient features of the IndicBART are:\n\n<ul>\n<li >Supported languages: Assamese, Bengali, Gujarati, Hindi, Marathi, Odiya, Punjabi, Kannada, Malayalam, Tamil, Telugu and English. Not all of these languages are supported by mBART50 and mT5. </li>\n<li >The model is much smaller than the mBART and mT5(-base) models, so less computationally expensive for finetuning and decoding. </li>\n<li> Trained on large Indic language corpora (452 million sentences and 9 billion tokens) which also includes Indian English content. </li>\n<li> All languages, except English, have been represented in Devanagari script to encourage transfer learning among the related languages. </li>\n</ul>\n\nYou can read more about IndicBART in this <a href=\"https://arxiv.org/abs/2109.02903\">paper</a>.\n\nFor detailed documentation, look here: https://github.com/AI4Bharat/indic-bart/ and https://indicnlp.ai4bharat.org/indic-bart/\n\n# Pre-training corpus\n\nWe used the <a href=\"https://indicnlp.ai4bharat.org/corpora/\">IndicCorp</a> data spanning 12 languages with 452 million sentences (9 billion tokens). The model was trained using the text-infilling objective used in mBART.\n\n# Usage:\n\n```\nfrom transformers import MBartForConditionalGeneration, AutoModelForSeq2SeqLM\nfrom transformers import AlbertTokenizer, AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained(\"ai4bharat/IndicBART\", do_lower_case=False, use_fast=False, keep_accents=True)\n\n# Or use tokenizer = AlbertTokenizer.from_pretrained(\"ai4bharat/IndicBART\", do_lower_case=False, use_fast=False, keep_accents=True)\n\nmodel = AutoModelForSeq2SeqLM.from_pretrained(\"ai4bharat/IndicBART\")\n\n# Or use model = MBartForConditionalGeneration.from_pretrained(\"ai4bharat/IndicBART\")\n\n# Some initial mapping\nbos_id = tokenizer._convert_token_to_id_with_added_voc(\"<s>\")\neos_id = tokenizer._convert_token_to_id_with_added_voc(\"</s>\")\npad_id = tokenizer._convert_token_to_id_with_added_voc(\"<pad>\")\n# To get lang_id use any of ['<2as>', '<2bn>', '<2en>', '<2gu>', '<2hi>', '<2kn>', '<2ml>', '<2mr>', '<2or>', '<2pa>', '<2ta>', '<2te>']\n\n# First tokenize the input and outputs. The format below is how IndicBART was trained so the input should be \"Sentence </s> <2xx>\" where xx is the language code. Similarly, the output should be \"<2yy> Sentence </s>\". \ninp = tokenizer(\"I am a boy </s> <2en>\", add_special_tokens=False, return_tensors=\"pt\", padding=True).input_ids # tensor([[  466,  1981,    80, 25573, 64001, 64004]])\n\nout = tokenizer(\"<2hi> \u092e\u0948\u0902  \u090f\u0915 \u0932\u095c\u0915\u093e \u0939\u0942\u0901 </s>\", add_special_tokens=False, return_tensors=\"pt\", padding=True).input_ids # tensor([[64006,   942,    43, 32720,  8384, 64001]])\n# Note that if you use any language other than Hindi or Marathi, you should convert its script to Devanagari using the Indic NLP Library.\n\nmodel_outputs=model(input_ids=inp, decoder_input_ids=out[:,0:-1], labels=out[:,1:])\n\n# For loss\nmodel_outputs.loss ## This is not label smoothed.\n\n# For logits\nmodel_outputs.logits\n\n# For generation. Pardon the messiness. Note the decoder_start_token_id.\n\nmodel.eval() # Set dropouts to zero\n\nmodel_output=model.generate(inp, use_cache=True, num_beams=4, max_length=20, min_length=1, early_stopping=True, pad_token_id=pad_id, bos_token_id=bos_id, eos_token_id=eos_id, decoder_start_token_id=tokenizer._convert_token_to_id_with_added_voc(\"<2en>\"))\n\n\n# Decode to get output strings\n\ndecoded_output=tokenizer.decode(model_output[0], skip_special_tokens=True, clean_up_tokenization_spaces=False)\n\nprint(decoded_output) # I am a boy\n# Note that if your output language is not Hindi or Marathi, you should convert its script from Devanagari to the desired language using the Indic NLP Library.\n\n# What if we mask?\n\ninp = tokenizer(\"I am [MASK] </s> <2en>\", add_special_tokens=False, return_tensors=\"pt\", padding=True).input_ids\n\nmodel_output=model.generate(inp, use_cache=True, num_beams=4, max_length=20, min_length=1, early_stopping=True, pad_token_id=pad_id, bos_token_id=bos_id, eos_token_id=eos_id, decoder_start_token_id=tokenizer._convert_token_to_id_with_added_voc(\"<2en>\"))\n\ndecoded_output=tokenizer.decode(model_output[0], skip_special_tokens=True, clean_up_tokenization_spaces=False)\n\nprint(decoded_output) # I am happy\n\ninp = tokenizer(\"\u092e\u0948\u0902 [MASK] \u0939\u0942\u0901 </s> <2hi>\", add_special_tokens=False, return_tensors=\"pt\", padding=True).input_ids\n\nmodel_output=model.generate(inp, use_cache=True, num_beams=4, max_length=20, min_length=1, early_stopping=True, pad_token_id=pad_id, bos_token_id=bos_id, eos_token_id=eos_id, decoder_start_token_id=tokenizer._convert_token_to_id_with_added_voc(\"<2en>\"))\n\ndecoded_output=tokenizer.decode(model_output[0], skip_special_tokens=True, clean_up_tokenization_spaces=False)\n\nprint(decoded_output) # \u092e\u0948\u0902 \u091c\u093e\u0928\u0924\u093e \u0939\u0942\u0901\n\ninp = tokenizer(\"\u092e\u0932\u093e [MASK] \u092a\u093e\u0939\u093f\u091c\u0947 </s> <2mr>\", add_special_tokens=False, return_tensors=\"pt\", padding=True).input_ids\n\nmodel_output=model.generate(inp, use_cache=True, num_beams=4, max_length=20, min_length=1, early_stopping=True, pad_token_id=pad_id, bos_token_id=bos_id, eos_token_id=eos_id, decoder_start_token_id=tokenizer._convert_token_to_id_with_added_voc(\"<2en>\"))\n\ndecoded_output=tokenizer.decode(model_output[0], skip_special_tokens=True, clean_up_tokenization_spaces=False)\n\nprint(decoded_output) # \u092e\u0932\u093e \u0913\u0933\u0916\u0932\u0902 \u092a\u093e\u0939\u093f\u091c\u0947\n\n```\n\n# Notes:\n1. This is compatible with the latest version of transformers but was developed with version 4.3.2 so consider using 4.3.2 if possible.\n2. While I have only shown how to get logits and loss and how to generate outputs, you can do pretty much everything the MBartForConditionalGeneration class can do as in https://huggingface.co/docs/transformers/model_doc/mbart#transformers.MBartForConditionalGeneration\n3. Note that the tokenizer I have used is based on sentencepiece and not BPE. Therefore, I used the AlbertTokenizer class and not the MBartTokenizer class.\n4. If you wish to use any language written in a non-Devanagari script (except English), then you should first convert it to Devanagari using the <a href=\"https://github.com/anoopkunchukuttan/indic_nlp_library\">Indic NLP Library</a>. After you get the output, you should convert it back into the original script.\n\n# Fine-tuning on a downstream task\n\n1. If you wish to fine-tune this model, then you can do so using the <a href=\"https://github.com/prajdabre/yanmtt\">YANMTT</a> toolkit, following the instructions <a href=\"https://github.com/AI4Bharat/indic-bart \">here</a>.\n2. (Untested) Alternatively, you may use the official huggingface scripts for <a href=\"https://github.com/huggingface/transformers/tree/master/examples/pytorch/translation\">translation</a> and <a href=\"https://github.com/huggingface/transformers/tree/master/examples/pytorch/summarization\">summarization</a>.\n\n# Contributors\n<ul>\n<li> Raj Dabre </li>\n<li> Himani Shrotriya </li>\n<li> Anoop Kunchukuttan </li>\n<li> Ratish Puduppully </li>\n<li> Mitesh M. Khapra </li>\n<li> Pratyush Kumar </li>\n</ul>\n\n# Paper\nIf you use IndicBART, please cite the following paper:\n```\n@misc{dabre2021indicbart,\n      title={IndicBART: A Pre-trained Model for Natural Language Generation of Indic Languages}, \n      author={Raj Dabre and Himani Shrotriya and Anoop Kunchukuttan and Ratish Puduppully and Mitesh M. Khapra and Pratyush Kumar},\n      year={2021},\n      eprint={2109.02903},\n      archivePrefix={arXiv},\n      primaryClass={cs.CL}\n    }    \n```\n\n# License\nThe model is available under the MIT License.", "size_bytes": "976429105", "downloads": 949}