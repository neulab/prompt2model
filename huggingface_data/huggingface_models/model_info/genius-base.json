{"pretrained_model_name": "beyond/genius-base", "description": "---\nlanguage: \n- en\n- zh\ntags:\n- GENIUS\n- conditional text generation\n- sketch-based text generation\n- data augmentation\nlicense: apache-2.0\ndatasets:\n- c4\n- beyond/chinese_clean_passages_80m\nwidget:\n- text: \"<mask> Conference on Empirical Methods <mask> submission of research papers <mask> Deep Learning <mask>\"\n  example_title: \"Example 1\"\n- text: \"<mask> machine learning <mask> my research interest <mask> data science <mask>\"\n  example_title: \"Example 2\"\n- text: \"<mask> play basketball <mask> a strong team <mask> Shanghai University of Finance and Economics <mask> last Sunday <mask>\"\n  example_title: \"Example 3\"\n- text: \"Good news: <mask> the European Union <mask> month by EU <mask> Farm Commissioner Franz <mask>\"\n  example_title: \"Example with a prompt 1\"\n- text: \"Bad news: <mask> the European Union <mask> month by EU <mask> Farm Commissioner Franz <mask>\"\n  example_title: \"Example with a prompt 2\"\n\ninference:\n  parameters:\n    max_length: 200\n    num_beams: 3\n    do_sample: True\n---\n\n# \ud83d\udca1GENIUS \u2013 generating text using sketches!\n\n**\u57fa\u4e8e\u8349\u7a3f\u7684\u6587\u672c\u751f\u6210\u6a21\u578b**\n\n- **Paper: [GENIUS: Sketch-based Language Model Pre-training via Extreme and Selective Masking for Text Generation and Augmentation](https://github.com/beyondguo/genius/blob/master/GENIUS_gby_arxiv.pdf)**\n\n\ud83d\udca1**GENIUS** is a powerful conditional text generation model using sketches as input, which can fill in the missing contexts for a given **sketch** (key information consisting of textual spans, phrases, or words, concatenated by mask tokens). GENIUS is pre-trained on a large- scale textual corpus with a novel *reconstruction from sketch* objective using an *extreme and selective masking* strategy, enabling it to generate diverse and high-quality texts given sketches.\n\n**Example 1:**\n\n- sketch: `__ machine learning __ my research interest __ data science __`\n- **GENIUS**: `I am a Ph.D. student in machine learning, and my research interest is in data science. I am interested in understanding how humans and machines interact and how we can improve the quality of life for people around the world.`\n\n**Example 2:**\n\n- sketch: `\u81ea\u7136\u8bed\u8a00\u5904\u7406__\u8c37\u6b4c__\u901a\u7528\u4eba\u5de5\u667a\u80fd__`\n- **GENIUS**: `\u81ea\u7136\u8bed\u8a00\u5904\u7406\u662f\u8c37\u6b4c\u5728\u901a\u7528\u4eba\u5de5\u667a\u80fd\u9886\u57df\u7684\u4e00\u4e2a\u91cd\u8981\u7814\u7a76\u65b9\u5411\uff0c\u5176\u76ee\u7684\u662f\u4e3a\u4e86\u4fc3\u8fdb\u4eba\u7c7b\u667a\u80fd\u7684\u53d1\u5c55\u3002 `\n\n\n\n**GENIUS** can also be used as a general textual **data augmentation tool** for **various NLP tasks** (including sentiment analysis, topic classification, NER, and QA). \n\n\n![image-20221119164544165](https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/typora/hi-genius.png)\n\n\n\n- Models hosted in \ud83e\udd17 Huggingface:\n\n**Model variations:**\n\n| Model | #params | Language | comment|\n|------------------------|--------------------------------|-------|---------|\n| [`genius-large`](https://huggingface.co/beyond/genius-large) | 406M   | English | The version used in **paper** (recommend) |\n| [`genius-large-k2t`](https://huggingface.co/beyond/genius-large-k2t)  | 406M    | English | keywords-to-text |\n| [`genius-base`](https://huggingface.co/beyond/genius-base)  | 139M    | English | smaller version |\n| [`genius-base-ps`](https://huggingface.co/beyond/genius-base)  | 139M    | English | pre-trained both in paragraphs and short sentences |\n| [`genius-base-chinese`](https://huggingface.co/beyond/genius-base-chinese) | 116M    | \u4e2d\u6587 | \u5728\u4e00\u5343\u4e07\u7eaf\u51c0\u4e2d\u6587\u6bb5\u843d\u4e0a\u9884\u8bad\u7ec3|\n\n![image-20221119191940969](https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/typora/202211191919005.png)\n\n\n\n\nMore Examples:\n\n![image-20221119184950762](https://cdn.jsdelivr.net/gh/beyondguo/mdnice_pictures/typora/202211191849815.png)\n\n## Usage\n\n### What is a sketch?\n\nFirst, what is a **sketch**? As defined in our paper, a sketch is \"key information consisting of textual spans, phrases, or words, concatenated by mask tokens\". It's like a draft or framework when you begin to write an article. With GENIUS model, you can input some key elements you want to mention in your wrinting, then the GENIUS model can generate cohrent text based on your sketch.\n\nThe sketch which can be composed of:\n\n- keywords /key-phrases, like `__NLP__AI__computer__science__`\n- spans, like `Conference on Empirical Methods__submission of research papers__`\n- sentences, like `I really like machine learning__I work at Google since last year__`\n- or a mixup!\n\n\n### How to use the model\n#### 1. If you already have a sketch in mind, and want to get a paragraph based on it...\n```python\nfrom transformers import pipeline\n# 1. load the model with the huggingface `pipeline`\ngenius = pipeline(\"text2text-generation\", model='beyond/genius-large', device=0)\n# 2. provide a sketch (joint by <mask> tokens)\nsketch = \"<mask> Conference on Empirical Methods <mask> submission of research papers <mask> Deep Learning <mask>\"\n# 3. here we go!\ngenerated_text = genius(sketch, num_beams=3, do_sample=True, max_length=200)[0]['generated_text']\nprint(generated_text)\n```\nOutput:\n```shell\n'The Conference on Empirical Methods welcomes the submission of research papers. Abstracts should be in the form of a paper or presentation. Please submit abstracts to the following email address: eemml.stanford.edu. The conference will be held at Stanford University on April 1618, 2019. The theme of the conference is Deep Learning.'\n```\n\nIf you have a lot of sketches, you can batch-up your sketches to a Huggingface `Dataset` object, which can be much faster.\n\nTODO: we are also building a python package for more convenient use of GENIUS, which will be released in few weeks.\n\n#### 2. If you have an NLP dataset (e.g. classification) and want to do data augmentation to enlarge your dataset...\n\nPlease check [genius/augmentation_clf](https://github.com/beyondguo/genius/tree/master/augmentation_clf) and [genius/augmentation_ner_qa](https://github.com/beyondguo/genius/tree/master/augmentation_ner_qa), where we provide ready-to-run scripts for data augmentation for text classification/NER/MRC tasks.\n\n\n\n## Augmentation Experiments:\nData augmentation is an important application for natural language generation (NLG) models, which is also a valuable evaluation of whether the generated text can be used in real applications. \n- Setting: Low-resource setting, where only n={50,100,200,500,1000} labeled samples are available for training. The below results are the average of all training sizes.\n- Text Classification Datasets: [HuffPost](https://huggingface.co/datasets/khalidalt/HuffPost), [BBC](https://huggingface.co/datasets/SetFit/bbc-news), [SST2](https://huggingface.co/datasets/glue), [IMDB](https://huggingface.co/datasets/imdb), [Yahoo](https://huggingface.co/datasets/yahoo_answers_topics), [20NG](https://huggingface.co/datasets/newsgroup).\n- Base classifier: [DistilBERT](https://huggingface.co/distilbert-base-cased)\n\n\nIn-distribution (ID) evaluations:\n|   Method   |    Huff    |     BBC    |    Yahoo   |    20NG    |    IMDB    |    SST2    |    avg.    |\n|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|:----------:|\n|    none    |   79.17   | **96.16** |   45.77   |   46.67   |   77.87   |   76.67   |   70.39   |\n|     EDA    |   79.20   |   95.11   |   45.10   |   46.15   |   77.88   |   75.52   |   69.83   |\n|    BackT   |   80.48   |   95.28   |   46.10   |   46.61   |   78.35   |   76.96   |   70.63   |\n|     MLM    |   80.04   |   96.07   |   45.35   |   46.53   |   75.73   |   76.61   |   70.06   |\n|    C-MLM   |   80.60   |   96.13   |   45.40   |   46.36   |   77.31   |   76.91   |   70.45   |\n|   LAMBADA  |   81.46   |   93.74   |   50.49   |   47.72   |   78.22   |   78.31   |   71.66   |\n|     STA    |   80.74   |   95.64   |   46.96   |   47.27   |   77.88   |   77.80   |   71.05   |\n|  **GeniusAug**  |   81.43   |   95.74   |   49.60   |   50.38   | **80.16** |   78.82   |   72.68   |\n| **GeniusAug-f** | **81.82** |   95.99   | **50.42** | **50.81** |   79.40   | **80.57** | **73.17** |\n\nOut-of-distribution (OOD) evaluations:\n|            |  Huff->BBC |  BBC->Huff | IMDB->SST2 | SST2->IMDB |    avg.    |\n|------------|:----------:|:----------:|:----------:|:----------:|:----------:|\n|    none    |   62.32   |   62.00   |   74.37   |   73.11   |   67.95   |\n|     EDA    |   67.48   |   58.92   |   75.83   |   69.42   |   67.91   |\n|    BackT   |   67.75   |   63.10   |   75.91   |   72.19   |   69.74   |\n|     MLM    |   66.80   |   65.39   |   73.66   |   73.06   |   69.73   |\n|    C-MLM   |   64.94   | **67.80** |   74.98   |   71.78   |   69.87   |\n|   LAMBADA  |   68.57   |   52.79   |   75.24   |   76.04   |   68.16   |\n|     STA    |   69.31   |   64.82   |   74.72   |   73.62   |   70.61   |\n|  **GeniusAug**  |   74.87   |   66.85   |   76.02   |   74.76   |   73.13   |\n| **GeniusAug-f** | **76.18** |   66.89   | **77.45** | **80.36** | **75.22** |\n\n### BibTeX entry and citation info\nTBD\n\n\n", "size_bytes": "557971987", "downloads": 15}