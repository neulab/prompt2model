{"pretrained_model_name": "Farnazgh/QA2D", "description": "---\nlanguage:\n- en\ndatasets:\n- SAMSum\nmetrics:\n- ROUGE-L\ntags:\n- Question answering\n- T5\n- Declarative\n- Text generation\nwidget:\n- text: \"q: do you have any hobbies that you like to do while you are at home ? a: watching online shows\"\n- text: \"q: do you watch a lot of comedy ? a: Yes, it will help calm the mind\"\n---\n\n# Transforming Question-Answer Pairs to Full Declarative Answer Form\n\nConsidering the question of \"Which drug did you take?\" and the answer of \"Doliprane\", the aim of this model is to derive a full answer to the question \"I took Doliprane\".\n\n## Model training\nWe fine-tune T5 (Raffel et al.,2019), a pre-trained encoder-decoder model, on two datasets of (question, incomplete answer, full answer) triples, one for wh- and one for yes-no(YN) questions. \nFor wh-questions, we use 3,300 entries of the dataset consisting of (question, answer, declarative answer sentence) triples gathered by Demszky et al. (2018) using Amazon Mechanical Turk workers. \nFor YN questions, we used the SAMSum corpus, (Gliwa et al., 2019) which contains short dialogs in chit-chat format. We created\n1,100 (question, answer, full answer) triples by au-\ntomatically extracting YN (question, answer) pairs\nfrom this corpus and manually associating them\nwith the corresponding declarative answer. Data\nwas splitted into train and test (9:1) and the fine-\ntuned model achieved 0.90 ROUGE-L score on the\ntest set.\n\n## Model Details\nModel was developed as one of the proposed modules in the following paper for dialog transformation. \n\n```\"F. Ghassemi Toudeshki, A. Liednikova, P Jolivet and C. Gardent, Exploring the Influence of Dialog Input Format for Unsupervised Clinical Questionnaire Filling, Proceedings of the 13th International Workshop on Health Text Mining and Information Analysis (co-located with EMNLP 2022), Abu Dhabi, 7 December 2022.\"``` \n\nIt was used to transform question-answer paris in information-seeking dialogs to declarative form and at the end to have the declarative transform of the whole dialog.\n\n\n## Test the model\n```python\n!pip install transformers\n!pip install sentencepiece\n```\n\n```python\nfrom transformers import AutoModelWithLMHead, AutoTokenizer\n\ntokenizer = AutoTokenizer.from_pretrained(\"Farnazgh/QA2D\")\nmodel = AutoModelWithLMHead.from_pretrained(\"Farnazgh/QA2D\")\n\ndef transform_qa2d(question, answer, max_length=150):\n  \n  text = \"q: \"+question+\" a: \"+answer\n  input_ids = tokenizer.encode(text, return_tensors=\"pt\", add_special_tokens=True)\n  generated_ids = model.generate(input_ids=input_ids, num_beams=2, max_length=max_length, early_stopping=True)[0]\n  preds = tokenizer.decode(generated_ids, skip_special_tokens=True, clean_up_tokenization_spaces=True)\n\n  return preds\n```", "size_bytes": "2950916820", "downloads": 19}